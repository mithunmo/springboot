(function(b){function x(g,a){var m,q,r;function w(a){b("body").addClass("noSelect");var c=parseInt(f.obj.css(k),10);m=n?a.pageX:a.pageY;q="auto"==c?0:c;t?(document.ontouchmove=function(a){a.preventDefault();s(a.touches[0])},document.ontouchend=p):(b(document).bind("mousemove",s),b(document).bind("mouseup",p),f.obj.bind("mouseup",p))}function u(d){if(1>c.ratio){d=d||window.event;e-=(d.wheelDelta?d.wheelDelta/120:-d.detail/3)*a.wheel;e=Math.min(c[a.axis]-j[a.axis],Math.max(0,e));f.obj.css(k,e/l.ratio);c.obj.css(k,-e);if(a.lockscroll||e!==c[a.axis]-j[a.axis]&&0!==e)d=b.event.fix(d),d.preventDefault();a.scrollChanged(c.obj)}}function s(d){1>c.ratio&&(r=a.invertscroll&&t?Math.min(h[a.axis]-f[a.axis],Math.max(0,q+(m-(n?d.pageX:d.pageY)))):Math.min(h[a.axis]-f[a.axis],Math.max(0,q+((n?d.pageX:d.pageY)-m))),e=r*l.ratio,c.obj.css(k,-e),f.obj.css(k,r),a.scrollChanged(c.obj))}function p(){b("body").removeClass("noSelect");b(document).unbind("mousemove",s);b(document).unbind("mouseup",p);f.obj.unbind("mouseup",p);document.ontouchmove=document.ontouchend=null}var j={obj:b(".viewport",g)},c={obj:b(".overview",g)},l={obj:b(".scrollbar",g)},h={obj:b(".track",l.obj)},f={obj:b(".thumb",l.obj)},n="x"===a.axis,k=n?"left":"top",v=n?"Width":"Height",e=0;r=q=0;m=void 0;var t="ontouchstart"in document.documentElement;this.update=function(d){j[a.axis]=j.obj[0]["offset"+v];c[a.axis]=c.obj[0]["scroll"+v];c.ratio=j[a.axis]/c[a.axis];l.obj.toggleClass("disable",1<=c.ratio);h[a.axis]="auto"===a.size?j[a.axis]:a.size;f[a.axis]=Math.min(h[a.axis],Math.max(0,"auto"===a.sizethumb?h[a.axis]*c.ratio:a.sizethumb));l.ratio="auto"===a.sizethumb?c[a.axis]/h[a.axis]:(c[a.axis]-j[a.axis])/(h[a.axis]-f[a.axis]);e="relative"===d&&1>=c.ratio?Math.min(c[a.axis]-j[a.axis],Math.max(0,e)):0;e="bottom"===d&&1>=c.ratio?c[a.axis]-j[a.axis]:isNaN(parseInt(d,10))?e:parseInt(d,10);d=v.toLowerCase();f.obj.css(k,e/l.ratio);c.obj.css(k,-e);m=f.obj.offset()[k];l.obj.css(d,h[a.axis]);h.obj.css(d,h[a.axis]);f.obj.css(d,f[a.axis])};this.update();t?j.obj[0].ontouchstart=function(a){1===a.touches.length&&(w(a.touches[0]),a.stopPropagation())}:(f.obj.bind("mousedown",w),h.obj.bind("mouseup",s));a.scroll&&window.addEventListener?(g[0].addEventListener("DOMMouseScroll",u,!1),g[0].addEventListener("mousewheel",u,!1),g[0].addEventListener("MozMousePixelScroll",function(a){a.preventDefault()},!1)):a.scroll&&(g[0].onmousewheel=u);return this}b.tiny=b.tiny||{};b.tiny.scrollbar={options:{axis:"y",wheel:40,scroll:!0,lockscroll:!0,size:"auto",sizethumb:"auto",scrollChanged:b.noop,invertscroll:!1}};b.fn.tinyscrollbar=function(g){var a=b.extend({},b.tiny.scrollbar.options,g);this.each(function(){b(this).data("tsb",new x(b(this),a))});return this};b.fn.tinyscrollbar_update=function(g){if(void 0!=b(this).data("tsb"))return b(this).data("tsb").update(g)}})(jQuery);