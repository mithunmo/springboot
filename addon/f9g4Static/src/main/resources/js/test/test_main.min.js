var basicConfig={debugMode:!1,writeLogToConsole:!1,disableRightClick:!1,enableSorting:!0},appConfig={ver:3,ratyImgPath:"/images/raty_img",shoppingCartImgPath:"/images/shoppingcart.png",shoppingCartFullImgPath:"/images/shoppingcart_full.png"},idleTimerConfig={idleTime:1500,pollingTime:300,warningTime:300,idleTimeoutDebugMode:!1},globalVars={isWindowFocus:!1,hasClicked:0,prePortfolioName:"",cart:null,isChangedWithoutSubmit:!1,isSidebaropened:!1},searchResult,searchResultProp={currentPage:0,totalPages:0,itemsPerPage:15},portfolioResult={data:null,imageList:null},portfolioProp={currentPage:0,totalPages:0,itemsPerPage:8,portfolioId:-1,preloadPortfolioId:-1,forceToReload:!1},boardsResult={portfolioId:null,data:null},boardProp={currentPage:0,totalPages:0,itemsPerPage:8,forceToReload:!1},layoutTemplate={emptyPortfolioMsg:'<div class="empty" style="width:320px;"><i></i><span><a href="javascript:void(0)" id="add_manage_portfolio" style="color:#C30">Click here</a>&nbsp;to create your first portfolio!</span></div>',emptyBoardMsg:'<div class="empty"><i></i><span><a href="javascript:void(0)" id="add_manage_board" style="color:#C30">Click here</a>&nbsp;to create your first board!</span></div>',loadingMsg:'<div class="loadingSpinner"><span><img src="/images/spinner.gif" /></span></div>',basicConsoleFrame:'<div class="left"><div class="searchTitle"></div></div><div class="right"><div class="rightCurve"></div></div><div class="contentFrame" ><div class="content" id="messages"><div class="loadingSpinner"><span><img src="/images/spinner.gif" /></span></div></div></div>',errorStyle:"color:#FF0000",optionDefaultMsg:'<option value="-1">-Please select one option-</option>',optionLoadingMsg:'<option value="-1">Loading...</option>',emptyPage:'<div class="empty"><i></i><span>Empty Page<br />Please Select Another Page</span></div>'};$(document).ready(function(){$(window).height();logging("LI=>"+sessionStorage.LI+" ; LUUI=>"+sessionStorage.LUUI);logging("main running.."+appConfig.ver);logging("Browser Version:"+window.navigator.userAgent);initIdleTimeoutPlugin();$(".cloud-zoom").livequery(function(){$(this).CloudZoom()});basicConfig.disableRightClick&&$(document).bind("contextmenu",function(){return!1});openSidebar();$(window).bind("load",function(){logging("load","#F00");checkSession()});$(window).bind("focus",function(){globalVars.isWindowFocus||(logging("focus","#F00"),checkSession());globalVars.isWindowFocus=!0});$(window).bind("blur",function(){globalVars.isWindowFocus=!1});$(window).bind("beforeunload",function(){logging("trigger beforeunload","#F00");$("input").blur();$("textarea").blur();$($("#tabs li")[$("#tabs").tabs("option","selected")]).text();if(globalVars.isChangedWithoutSubmit||isChangedWithoutSubmitOnPopup)return logging(globalVars.isChangedWithoutSubmit+" ; "+isChangedWithoutSubmitOnPopup),"Do you want to leave the page without saving"});$(document).on("change","#form_create_board input",function(){globalVars.isChangedWithoutSubmit=!0});$(document).on("change","#form_edit_profile input",function(){globalVars.isChangedWithoutSubmit=!0});$(document).on("change","#form_create_portfolio input",function(){globalVars.isChangedWithoutSubmit=!0});$(document).on("change","#messageContent",function(){globalVars.isChangedWithoutSubmit=!0});$(document).on("change","#replyForm input",function(){globalVars.isChangedWithoutSubmit=!0});$(document).on("change",".popup input[type=text]",function(){isChangedWithoutSubmitOnPopup=!0});$(document).on("change",".popup textarea",function(){isChangedWithoutSubmitOnPopup=!0});$("#tabs").tabs({spinner:"Loading..",fx:{opacity:"toggle",duration:"fast"},select:function(a,b){if(globalVars.isChangedWithoutSubmit)a.preventDefault(),showConfirmation("You leave the page with unsaved data, Continue?","Confirmation","changedWithoutSave",{onOk:function(){globalVars.isChangedWithoutSubmit=!1;$("#tabs").tabs("select",b.index)}});else{checkSession();var g=b.tab.hash,f={"#tab_home":function(){location.hash="#home";$("#tabs").tabs("load",getIdByName("tab_home"))},"#tab_home_edit_mode":function(){$("#tab_home_edit_mode").html(layoutTemplate.basicConsoleFrame)},"#tab_designer_home_edit_mode":function(){$("#tab_designer_home_edit_mode").html(layoutTemplate.basicConsoleFrame)},"#tab_search_criteria":function(){location.hash="#search_criteria";if(""==$("#tab_search_criteria").html())logging("LOAD SEARCH CRITERIA"+getIdByName("tab_search_criteria"),"#F00"),$("#tabs").tabs("url",getIdByName("tab_search_criteria"),searchCriteriaPath);else{logging("enable cache","#F00");var a=$("#tabs").data("tabs").anchors[1];$(a).data("cache.tabs",!0)}},"#tab_activity_company":function(){$(g).html(layoutTemplate.basicConsoleFrame);location.hash="#activity"},"#tab_activity_designer":function(){$(g).html(layoutTemplate.basicConsoleFrame);location.hash="#activity"},"#tab_design_wall":function(){location.hash="#design_wall_0_1_1";$("#tab_design_wall").html(layoutTemplate.basicConsoleFrame)},"#tab_alerts":function(){$("#tab_alerts").html(layoutTemplate.basicConsoleFrame);location.hash="#alerts";$("#tabs").tabs("load",getIdByName("tab_alerts"))},"#tab_messages":function(){logging("show message loading..","#F00");location.hash="#messages_page_1";$("#tab_messages").html(layoutTemplate.basicConsoleFrame)},"#tab_manage_portfolio":function(){$("#portfolio_mask").html('<div class="data">'+layoutTemplate.loadingMsg+"</div>")},"#tab_search_result":function(){syncMarket()},"#tab_create_board":function(){$("#tab_create_board").html(layoutTemplate.basicConsoleFrame)},"#tab_account":function(){location.hash="#designer_account_0_1_1";$("#tab_account").html(layoutTemplate.basicConsoleFrame)}};logging("SELECT tabName="+g);globalVars.hasClicked++;1<=globalVars.hasClicked&&closeSidebar();if("function"===typeof f[g])f[g]();else logging("Undefined tab name")}},load:function(a,b){var g=b.tab.hash,f={"#tab_search_criteria":function(){initSeasonsList("checkbox")},"#tab_search_result":function(){logging("show search result")},"#tab_design_wall":function(){},"#tab_messages":function(){$("#messages_scrollbar").tinyscrollbar()},"#tab_activity_designer":function(){logging("activity designer tab");init_raty_activity();initChart(chartPath+"/30");disableChartLink("#chart_month")},"#tab_activity_company":function(){logging("activity designer tab");init_raty_activity();initChart(chartPath+"/30");disableChartLink("#chart_month")},"#tab_rating_designer":initRaty,"#tab_rating_company":initRaty,"#tab_rating":initRaty,"#tab_manage_portfolio":function(){},"#tab_manage_board":function(){getBoardsByPage(boardsResult.portfolioId,boardProp.currentPage,boardProp.forceToReload)},"#tab_create_board":function(){logging("load create board tab")},"#tab_create_portfolio":function(){logging("season Path=>"+seasonYearListPath);$("#season").html("Loading Data, Please wait...");$.ajax({url:seasonYearListPath+"/radio",type:"GET",success:function(a){a=processJSONObject(a);$("#season").tree({data:a,autoOpen:!1,dragAndDrop:!1})}});getCategoryList($("#form_division").val());$("#form_name_of_portfolio").val(globalVars.prePortfolioName);globalVars.prePortfolioName=""}};if("function"===typeof f[g])f[g]();else logging("Undefined tab name")},show:function(a,b){var g=b.tab.hash,f={"#tab_init_raty_activity":function(){logging("set raty value");init_raty_activity()},"#tab_activity_company":function(){logging("set raty value");init_raty_activity()},"#tab_manage_portfolio":function(){-1==location.hash.search("#portfolio_page")?location.hash="#portfolio_page_0_1":getPortfolioItemsByPage(portfolioProp.currentPage,!0);logging('<span style="color:#FF0000">content=>'+$("#portfolio_mask .data").html()+"</span>")},"#tab_manage_board":function(){logging("Show Manage Boards=>"+portfolioProp.portfolioId)},"#tab_create_board":function(){logging("SHOW CREATE BOARD");$("#portfolioId").trigger("change")},"#tab_search_result":function(){logging("sync shopping cart and market.");syncMarket()},"#tab_messages":function(){$("#messages_scrollbar").tinyscrollbar()},"#tab_tab_home":function(){$("#skill_scrollbar").tinyscrollbar();$("#lang_scrollbar").tinyscrollbar();$("#about_you_scrollbar").tinyscrollbar();$("#misc_scrollbar").tinyscrollbar()}};"function"===typeof f[g]?(logging("Execute "+f[g]+" handler"),f[g]()):logging("Undefined tab name handler")}});-1!=getIdByName("tab_search_result")&&$("#tabs").tabs("disable","tab_search_result");""==location.hash&&(getCart(),$("#tabs").tabs("select","tab_messages"));$(document).on("click","#submit_search_criteria",function(){getSearchResult()});$(document).on("click","#link_save_search_criteria",function(){closeSidebar();buildPopup({url:saveSearchCriteriaPath})});$(document).on("change","#form_open_saved_searches",function(){""!=this.value&&logging("select searches=>"+this.value)});$(document).on("change","#form_division_search_criteria",function(a){$("#form_product").html("<option value=-1>-Please select Category above-</option>");$("#form_product_type").html("<option value=-1>-Please select Product above-</option>");getCategoryList(a.target.value)});$(document).on("change","#form_category",function(a){getProductList(a.target.value)});$(document).on("change","#form_product",function(a){getProductTypeList(a.target.value)});$(document).on("click","#clear_search_criteria",function(){$("#form_search_criteria")[0].reset();initSeasonsList("checkbox")});$(document).on("click","#back_search_criteria",function(){logging("back");$("#tabs").tabs("enable","tab_search_criteria");$("#tabs").tabs("select","tab_search_criteria");$("#tabs").tabs("disable","tab_search_result")});$(document).on("click",".add_to_cart",function(a){moveToCart(a.currentTarget.id)});$(document).on("click","#add_to_cart",function(){closeSidebar();buildPopup({url:addToCartPath},function(){$(".popup .entity").tinyscrollbar()})});$(document).on("click","#empty_search_ok",function(){logging("back");$("#tabs").tabs("enable","tab_search_criteria");$("#tabs").tabs("select","tab_search_criteria");$("#tabs").tabs("disable","tab_search_result")});$(document).on("click",".boardLink",function(){logging("boardLink clicked","#0F0");logging("hash=>"+location.hash,"#0F0");logging("data=>"+$(this).attr("data"),"#0F0");var a=$(this).attr("data");location.hash=="#nail_"+a?(logging("trigger hash change"),$(window).hashchange()):location.hash="nail_"+a});$(document).on("mouseenter",".nail a",function(a){$(a.currentTarget.parentNode).css({"background-color":"#DDD"})});$(document).on("mouseleave",".nail a",function(a){$(a.currentTarget.parentNode).css({"background-color":"white"})});$(document).on("mouseenter",".touchbar",function(){$(this).addClass("appear");$(this).removeClass("disappear");$(this).animate({opacity:.4},0)});$(document).on("mouseleave",".touchbar",function(){$(this).addClass("disappear");$(this).removeClass("appear");$(this).animate({opacity:0},0)});$(document).on("click","#search_carouselNext",function(){logging("next");logging("Current page=>"+searchResultProp.currentPage,"#00F");searchResultProp.currentPage++;searchResultProp.currentPage>=searchResultProp.totalPages&&(searchResultProp.currentPage=0);location.hash="#search_page_"+searchResultProp.currentPage});$(document).on("click","#search_carouselPrev",function(){logging("prev");logging("Current page=>"+searchResultProp.currentPage,"#00F");searchResultProp.currentPage--;0>searchResultProp.currentPage&&(searchResultProp.currentPage=searchResultProp.totalPages-1);location.hash="#search_page_"+searchResultProp.currentPage});$(document).on("change","#sortSearchResult",function(){logging("sort search result=>"+this.value);sortSearchResult(this.value)});$(window).hashchange(function(){hashChange()});$(window).hashchange();$(window).resize(function(){resize();$("#sidebar_scrollbar").tinyscrollbar_update()});$(document).on("click","#sidebarToggle",function(){!1==globalVars.isSidebarOpened?openSidebar():closeSidebar()});$(document).on("mouseenter","#sidebarToggle",function(){$("#sidebarToggle").css({backgroundColor:"#DDD"})});$(document).on("mouseleave","#sidebarToggle",function(){$("#sidebarToggle").css({backgroundColor:"#bdcbd4"})});$(document).on("click","#sidebar_alerts",function(){logging("alerts");$("#tabs").tabs("select","tab_alerts")});$(document).on("click","#sidebar_messages",function(){logging("messages");location.hash="#messages_page_1"});$(document).on("click",".drawer_boardId",function(){logging("board id=>"+$(this).attr("data"));showWindow($(this).attr("data"))});$(document).on("click","#prevItem",function(){logging($("#prevItem").attr("href"));location.hash=$("#prevItem").attr("href")});$(document).on("click","#nextItem",function(){logging($("#nextItem").attr("href"));location.hash=$("#nextItem").attr("href")});$(document).on("click","#referralButton",function(){logging("referral button click");closeSidebar();buildPopup({url:referralPath})});$(document).on("click","#update_membership",function(){logging("update membership")});$(document).on("click","#update_new",function(){logging("update new image");closeSidebar();buildUploadPopup({url:uploadPicturesPath,mode:"LOGO",filetype:"ai",previewArea:"#previewImage"})});$(document).on("click","#manage_referrals",function(){logging("manage referrals");closeSidebar();buildPopup({url:manageReferralsPath},function(){$(".popup .entity").tinyscrollbar()})});$(document).on("upload_finished","body",function(a){logging("USER LOGO UPLOAD FINISHED=>"+a.filename_400);-1!=a.filestatus&&(globalVars.isChangedWithoutSubmit=!0,$("#form_logo_image_url").val("/400x400/"+a.filename_400),$("#previewImage").html('<i></i><img src="/400x400/'+a.filename_400+'" />'))});$(document).on("change","#website",function(){/^http:\/\//.test(this.value)||(this.value="http://"+this.value)});$(document).on("click","#edit_profile_company",function(){logging("show edit mode");$("#tabs").tabs("select","tab_home_edit_mode")});$(document).on("click","#save_company",function(){doSaveCompany()});$(document).on("click","#cancel_company",function(){logging("cancel company");$("#tabs").tabs("select","tab_home")});$(document).on("click","#edit_profile_designer",function(){$("#tabs").tabs("select","tab_designer_home_edit_mode")});$(document).on("click","#save_designer",function(){doSaveDesigner()});$(document).on("click","#cancel_designer",function(){logging("cancel designer");$("#tabs").tabs("select","tab_home")});$(document).on("change","#select_sort_design_wall",function(a){logging("SORT=>"+a.currentTarget.value);location.hash="#design_wall_0_"+a.currentTarget.value+"_1"});$(document).on("click",".userinfo",function(){logging("click user id=>"+encodeURIComponent($(this).attr("data")));closeSidebar();buildPopup({url:userInfoPath+"?profileUserName="+encodeURIComponent($(this).attr("data"))+"&profileUserId="},function(){$(".popup .entity").tinyscrollbar()})});$(document).on("click",".designWallBoardId",function(){logging("click board id=>"+$(this).attr("data"),"#FF0");showWindow($(this).attr("data"))});$(document).on("change","#select_sort_account",function(){logging("SORT=>"+$(this).val());var a=$(this).val();location.hash="#designer_account_0_"+a+"_1"});$(document).on("click",".designerAccountBoardId",function(){logging("click board id=>"+$(this).attr("data"),"#FF0");showWindow($(this).attr("data"))});$(document).on("click",".designerAccountUserId",function(){logging("click user id=>"+encodeURIComponent($(this).attr("data")));closeSidebar();buildPopup({url:userInfoPath+"?profileUserName=&profileUserId="+encodeURIComponent($(this).attr("data"))},function(){$(".popup .entity").tinyscrollbar()})});$(document).on("click","#submit_rating_company",function(){logging("submit rating company")});$(document).on("click","#cancel_rating_company",function(){logging("cancel rating company");$("#tabs").tabs("select","tab_alerts")});$(document).on("click","#submit_rating_designer",function(){logging("submit rating designer")});$(document).on("click","#cancel_rating_designer",function(){logging("cancel rating designer");$("#tabs").tabs("select","tab_alerts")});var a="ASC",b="ASC";$(document).on("click","#messages_all",function(){"ASC"==a?($("#messages_all_arrow").addClass("upArrow"),a="DSC",logging("all messages DSC")):($("#messages_all_arrow").removeClass("upArrow"),a="ASC",logging("all messages ASC"))});$(document).on("click","#messages_newest",function(){"ASC"==b?($("#messages_newest_arrow").addClass("upArrow"),b="DSC",logging("newest messages DSC")):($("#messages_newest_arrow").removeClass("upArrow"),b="ASC",logging("newest messages ASC"))});$(document).on("click",".messageBoardId",function(){logging("board id=>"+$(this).attr("data"));showWindow($(this).attr("data"))});$(document).on("click",".messages_fromUserId",function(){logging("from user id=>"+$(this).attr("data")+" ; path=>"+userInfoPath+"?profileUserName=&profileUserId="+$(this).attr("data"));closeSidebar();buildPopup({url:userInfoPath+"?profileUserName=&profileUserId="+$(this).attr("data")},function(){$(".popup .entity").tinyscrollbar()})});$(document).on("click","#send_reply",function(){sendMessageInMessageDetail()});$(document).on("click","#back_to_messages",function(){globalVars.isChangedWithoutSubmit?showConfirmation("You leave the page with unsaved data, Continue?","Confirmation","changedWithoutSave",{onOk:function(){globalVars.isChangedWithoutSubmit=!1;location.hash="#messages_page_1";$("#tab_messages").html(layoutTemplate.basicConsoleFrame)}}):(location.hash="#messages_page_1",$("#tab_messages").html(layoutTemplate.basicConsoleFrame))});$(document).on("click","#messages_select_all",function(){$(".form_message_check").attr("checked","checked")});$(document).on("click","#messages_select_none",function(){$(".form_message_check").removeAttr("checked")});$(document).on("click",".messageDetailBoardId",function(){logging("board id=>"+$(this).attr("data"));showWindow($(this).attr("data"))});$(document).on("click",".messageDetailDesignerId",function(){logging("user id=>"+$(this).attr("data"));closeSidebar();buildPopup({url:userInfoPath+"?profileUserName=&profileUserId="+$(this).attr("data")},function(){$(".popup .entity").tinyscrollbar()})});$(document).on("click","#buttonShowMore",function(){logging("Show more messages","#FF0");$("#buttonShowMore").fadeOut(function(){$("#message_detail .message_content .hidden").removeClass("hidden");wrapMessageDetail(3);$("#message_content_scrollbar").tinyscrollbar_update("relative");$("#buttonShowMore").remove()})});$(document).on("keyup","#messageContent",function(){var a=$("#messageContent").val().length;$("#leftWords").html(1e3-a)});$(document).on("click",".readMore",function(){$(this).prev().animate({height:$(this).prev().children(".context").height()+5},function(){$("#message_content_scrollbar").tinyscrollbar_update("relative")});$(this).removeClass("readMore");$(this).addClass("hideContext").children("a").html("Hide")});$(document).on("click",".hideContext",function(){$(this).prev().animate({height:56},function(){$("#message_content_scrollbar").tinyscrollbar_update("relative")});$(this).removeClass("hideContext");$(this).addClass("readMore").children("a").html("Read more...")});$(document).on("click","#expandAll",function(){if(0<$("#buttonShowMore").length)$("#buttonShowMore").fadeOut(10,function(){$("#message_detail .message_content .hidden").removeClass("hidden");wrapMessageDetail(3);$("#message_content_scrollbar").tinyscrollbar_update("relative");for(var a=$(".readMore").toArray(),b=0;b<a.length;b++)$(a[b]).trigger("click");$("#buttonShowMore").remove()});else for(var a=$(".readMore").toArray(),b=0;b<a.length;b++)$(a[b]).trigger("click");$("#expandAll").attr("id","collapseAll");$("#collapseAll").html("Collapse All")});$(document).on("click","#collapseAll",function(){for(var a=$(".hideContext").toArray(),b=0;b<a.length;b++)$(a[b]).trigger("click");$("#collapseAll").attr("id","expandAll");$("#expandAll").html("Expand All")});$(document).on("click","#upload_ai",function(){logging("upload ai");var a="ai";"checked"==$("#form_saletype_1").attr("checked")&&(a="jpg");closeSidebar();buildUploadPopup({url:uploadPicturesPath,mode:"BOARD",filetype:a,previewArea:"#create_board_review",event:"upload_finished_board"})});$(document).on("upload_finished_board","body",function(a){logging("upload_finished_board=>"+a.filename);-1!=a.filestatus&&(globalVars.isChangedWithoutSubmit=!0,$("#form_board_image_url").val(a.filename),$("#form_board_image_type").val(a.filename_ext),$("#form_board_image_urL_file").val(a.filename_400),$("#form_board_image_urL_thumb").val(a.filename_100),$("#form_board_image_urL_main").val(a.filename_original))});$(document).on("click","#create_board_review",function(){logging("Get enlarge image");""!=$("#form_board_image_urL_main").val()&&showEnlargeImage($("#form_board_image_urL_main").val())});$(document).on("click","#new_portfolio",function(){logging("new portfolio");logging("CREATE PORTFOLIO=>"+$("#form_new_portfolio").val());$("#tabs").tabs("select","tab_create_portfolio");globalVars.prePortfolioName=$("#form_new_portfolio").val()});$(document).on("click",'#saleTypeTable [type="radio"]',function(a){if(checkFileTypeAndSaleType()){a=a.currentTarget.id.split("_");clearSaleTypeTable();var b=$("#"+a[1]+"_"+a[2]).html();$("#"+a[1]+"_"+a[2]).html('<input name="saletype_'+a[2]+'_cost" type="text" id="form_saletype_'+a[2]+'_cost" class="cost" value="'+b+'"/>')}else a.preventDefault()});$(document).on("click","#create_board_calculate",function(){calculate()});$(document).on("click","#create_board_clear",function(){clear()});$(document).on("change",".cost",function(){calculate()});$(document).on("click","#save_create_board",function(a){var b=createBoardInputChecking(a);0==b.length?checkFileTypeAndSaleType()&&showConfirmation('It will <span style="color:#F00">NOT</span> publish your board to MarketPlace. Continue?',"Confirmation","save_create_board",{onOk:function(){logging("Confirmation result=>"+a.trigger);logging("save create board");$("#form_publish_to_mp").val("0");createBoard(!1)}}):buildPopupMsg({content:"The fields need to be enter in the following fields which are already highlighted in correspond fields:<br/>"+b.join("<br/>"),showOk:!0})});$(document).on("click","#publish_create_board",function(a){var b=createBoardInputChecking(a);0==b.length?checkFileTypeAndSaleType()&&showConfirmation("It will publish your board to MarketPlace. Continue?","Confirmation","publish_create_board",{onOk:function(){logging("Confirmation result=>"+a.trigger);logging("publish board");$("#form_publish_to_mp").val("1");createBoard(!0)}}):buildPopupMsg({content:"The fields need to be enter in the following fields which are already highlighted in correspond fields:<br/>"+b.join("<br/>"),showOk:!0})});$(document).on("click","#cancel_create_board",function(){logging("cancel create board");globalVars.isChangedWithoutSubmit?showConfirmation("You leave the page with unsaved data, Continue?","Confirmation","changedWithoutSaveOnCreateBoard",{onOk:function(){globalVars.isChangedWithoutSubmit=!1;window.history.back()}}):window.history.back()});$(document).on("click","#portfolioId",function(){$("#portfolioId").unbind("change");$("#portfolioId").bind("change",function(a){logging("portfolio id change=>"+a.target.value);$("#product").html("");$("#productType").html("");logging("AJAX url=>"+productListByPortfolioPath+"/"+a.target.value);$.ajax({url:productListByPortfolioPath+"/"+a.target.value,type:"GET",success:function(a){for(var b="",c=0;c<a.list.length;c++)b+="<option value="+a.list[c].categoryId+">"+a.list[c].name+"</option>";$("#product").html(b)}})})});$(document).on("click","#product",function(){$("#product").unbind("change");$("#product").bind("change",function(a){logging("Product change=>"+a.target.value);$("#productType").html("");$.ajax({url:productTypeListPath+"/"+a.target.value,type:"GET",success:function(a){for(var b="",c=0;c<a.list.length;c++)b+="<option value="+a.list[c].categoryId+">"+a.list[c].name+"</option>";$("#productType").html(b)}})})});$(document).on("click","#showCommission",function(){logging("show commission");showCommission()});$(document).on("click","#price_guideline_link",function(){logging("show price guide line");closeSidebar();buildPopup({url:showPriceGuidelinePath})});$(document).on("click","#save_create_portfolio",function(){logging("save create portfolio");createPortfolio()});$(document).on("click","#cancel_create_portfolio",function(){logging("cancel create portfolio");$("#tabs").tabs("select","tab_manage_portfolio")});$(document).on("click","#add_new_board",function(){location.hash="#create_board"});$(document).on("change","#form_division",function(a){logging("division change=>"+a.target.value);getCategoryList(a.target.value)});$(document).on("click","#chart_today",function(){logging("show today");initChart(chartPath+"/1");disableChartLink("#chart_today")});$(document).on("click","#chart_week",function(){logging("show week");initChart(chartPath+"/7");disableChartLink("#chart_week")});$(document).on("click","#chart_month",function(){logging("show month");initChart(chartPath+"/30");disableChartLink("#chart_month")});$(document).on("click",".gridBoardId",function(){logging("board id=>"+$(this).attr("data"));showWindow($(this).attr("data"))});$(document).on("click",".gridDesignerName",function(){logging("click user id=>"+encodeURIComponent($(this).attr("data")));closeSidebar();buildPopup({url:userInfoPath+"?profileUserName=&profileUserId="+encodeURIComponent($(this).attr("data"))},function(){$(".popup .entity").tinyscrollbar()})});$(document).on("click","#clear_manage_portfolio",function(){$("input").removeAttr("checked")});$(document).on("click","#add_manage_portfolio",function(){logging("add portfolio");$("#tabs").tabs("select","tab_create_portfolio")});$(document).on("click","#delete_manage_portfolio",function(){logging("delete portfolio");deletePortfolio()});$(document).on("click","#manage_portfolio a",function(){location.hash="#board_page_"+$(this).attr("data")+"_0"});$(document).on("mouseenter","#manage_portfolio a",function(){$(this).children("div").eq(0).addClass("shadow")});$(document).on("mouseleave","#manage_portfolio a",function(){$(this).children("div").eq(0).removeClass("shadow")});$(document).on("mouseenter","#manage_portfolio",function(){$("#manage_portfolio_frame .touchbar").addClass("appear");$("#manage_portfolio_frame .touchbar").removeClass("disappear");$("#manage_portfolio_frame .touchbar").animate({opacity:.4},"fast")});$(document).on("mouseleave","#manage_portfolio",function(){$("#manage_portfolio_frame .touchbar").addClass("disappear");$("#manage_portfolio_frame .touchbar").removeClass("appear");$("#manage_portfolio_frame .touchbar").animate({opacity:0},"fast")});$(document).on("click","#portfolio_carouselPrev",function(){logging("portfolio prev");portfolioProp.currentPage--;0>portfolioProp.currentPage&&(portfolioProp.currentPage=portfolioProp.totalPages-1);location.hash="#portfolio_page_"+portfolioProp.currentPage+"_0"});$(document).on("click","#portfolio_carouselNext",function(){logging("portfolio next");portfolioProp.currentPage++;portfolioProp.currentPage>=portfolioProp.totalPages&&(portfolioProp.currentPage=0);location.hash="#portfolio_page_"+portfolioProp.currentPage+"_0"});$(document).on("click",".delete_portfolio",function(){logging("delete portfolio=>"+parseInt($(this).attr("data")));var a=parseInt($(this).attr("data"));showConfirmation("The portfolio is going to be deleted. Coninue ?","Confirmation","delete_portfolio",{onOk:function(){deletePortfolio(a)},onCancel:function(){logging("cancel")}})});$(document).on("click","#show_all_portfolios a",function(){logging("Show all portfolio","#F90");$("#tabs").tabs("select","tab_manage_portfolio")});$(document).on("change","#portfolio_catalog",function(a){logging("change location=>"+a.currentTarget.value);location.hash="#board_page_"+a.currentTarget.value+"_0"});$(document).on("click","#publish_manage_board",function(){logging("publish board")});$(document).on("click","#add_manage_board",function(){logging("add new board under portfolio =>"+$("#portfolio_catalog").val());location.hash="#create_board_"+$("#portfolio_catalog").val()});$(document).on("click","#delete_manage_board",function(){logging("delete selected board");deleteBoard()});$(document).on("click","#clear_manage_board",function(){$("#form_boards")[0].reset()});$(document).on("mouseenter","#manage_board .designerBoardLink",function(){$(this).parent().addClass("shadow")});$(document).on("mouseleave","#manage_board .designerBoardLink",function(){$(this).parent().removeClass("shadow")});$(document).on("click","#board_carouselPrev",function(){prevBoardPage()});$(document).on("click","#board_carouselNext",function(){nextBoardPage()});$(document).on("refresh_board","body",function(a,b){logging("REFRESH BOARD BY EVENT");refreshBoards(b)});$(document).on("click",".designerBoardLink",function(){logging("boardLink clicked","#0FF");logging("hash=>"+location.hash,"#0FF");logging("data=>"+$(this).attr("data"),"#0FF");var a=$(this).attr("data");location.hash=="#board_item_"+a?(logging("trigger hash change"),$(window).hashchange()):location.hash="board_item_"+a});$(document).on("click",".delete_board",function(a){logging("delete board=>"+parseInt($(this).attr("data")));var b=$(this).attr("data");showConfirmation("The board is going to be deleted. Coninue ?","Confirmation","delete_board",{onOk:function(){logging("Confirmation result=>"+a.trigger);deleteBoard(b)}})});$(document).on("click",".togglePubstatus_board",function(a){logging("toggle board status to public=>"+$(this).attr("data"));var b=$(this).attr("data");showConfirmation("The status of the board is going to be changed. Coninue ?","Confirmation","togglePubstatus_board",{onOk:function(){logging("Confirmation result=>"+a.trigger);ToggleStatusBoard(b)}})});$(document).on("click",".toggleHidstatus_board",function(a){logging("toggle board status to hidden=>"+$(this).attr("data"));var b=$(this).attr("data");showConfirmation("The status of the board is going to be changed. Coninue ?","Confirmation","toggleHidstatus_board",{onOk:function(){logging("Confirmation result=>"+a.trigger);ToggleStatusBoard(b)}})});$(document).on("click","#back_to_search_result",function(){logging("back to results");$("#tabs").tabs("enable","tab_search_result");$("#tabs").tabs("select","tab_search_result");$("#tabs").tabs("disable","tab_search_criteria")});$(document).on("click","#shopping_cart_update",function(){logging("shopping cart update");$("#form_shopping_cart").serialize();logging("FORM DATA=>"+$("#form_shopping_cart").serialize());$.ajax({url:deleteMultiItemsPath,type:"POST",data:$("#form_shopping_cart").serialize(),success:function(a){logging("DELETE SUCCESS");globalVars.cart=a;checkShoppingCart(a.count);$("#tabs").tabs("load",getIdByName("tab_shopping_cart"))}})});$(document).on("click","#shopping_cart_terms",function(){closeSidebar();displayLatestTermAndConditions(CustomerSaleTermsPath)});$(document).on("click","#terms_ok",function(){logging("terms_ok");$("#form_checkOutTAndC").attr("checked","checked");"checked"==$("#terms_agree").attr("checked")?($('input[name="termsId"]').val(),closePopup(),$("#form_checkOutTAndC").attr("checked","checked")):"checked"==$("#terms_decline").attr("checked")&&(closePopup(),$("#form_checkOutTAndC").removeAttr("checked"))});$(document).on("click","#shopping_cart_checkout",function(){logging("check out")});$(document).on("submit","#form_shoppingcart_checkout",function(){logging("form_shoppingcart_checkout");if("checked"!=$("#form_checkOutTAndC").attr("checked"))return buildPopupMsg({content:"Please Accept the Sales Terms and conditions before proceeding to checkout. Thanks",showOk:!0}),!1;$("#shopping_cart_checkout").prop("disabled",!0);$("#form_shoppingcart_checkout").prop("disabled",!0);logging("checkout","#F00");$("#paynowMask").css("z-index","10")});$(document).on("click",".checkoutBoardId",function(){logging("board id=>"+$(this).attr("data"));showWindow($(this).attr("data"))});$(document).on("click",".checkoutDesignerId",function(){logging("designer id=>"+$(this).attr("data"));
closeSidebar();buildPopup({url:userInfoPath+"?profileUserName=&profileUserId="+$(this).attr("data")},function(){$(".popup .entity").tinyscrollbar()})});$(document).on("click","#back_to_search_results",function(){logging("back to search results");closePopup()});$(document).on("click","#to_checkout",function(){logging("to checkout");closePopup();"#shopping_cart"==location.hash?$(window).hashchange():location.hash="#shopping_cart"});$(document).on("click",".shoppingCartBoardId",function(){logging("board id=>"+$(this).attr("data"));showWindow($(this).attr("data"))});$(document).on("click",".shoppingCartDesignerId",function(){logging("designer id=>"+$(this).attr("data"));closeSidebar();buildPopup({url:userInfoPath+"?profileUserName=&profileUserId="+$(this).attr("data")},function(){$(".popup .entity").tinyscrollbar()})});$(document).on("click","#add_to_shopping_cart",function(){logging("add to cart","#00F");addToCart($(this).attr("data"))});$(document).on("click","#remove_from_shopping_cart",function(){logging("remove from cart","#00F");removeFromCart($(this).attr("data"))});$(document).on("click","#form_send_comment",function(){logging("send message");sendMessage()});$(document).on("click",".boards_suggestion_boardId",function(){logging("show board=>"+$(this).attr("data"));showWindow($(this).attr("data"),!1)});$(document).on("click",".enlargeImage",function(){showEnlargeImage($(this))});$(document).on("click","#referral_submit",function(){logging($("#form_referral").serialize());logging("referral submit");$.ajax({url:submitReferralPath,type:"POST",dataType:"json",data:$("#form_referral").serialize(),success:function(a){logging("Send referral data success");"SUCCESS"==a[0]?($("#addReferralResult").css("color","blue"),$("#addReferralResult").html(a[1]),$("#form_referral")[0].reset(),isChangedWithoutSubmitOnPopup=!1):($("#addReferralResult").css("color","red"),$("#addReferralResult").html(a[1]))}})});$(document).on("click",".edit_referral",function(a){logging("edit referral=>"+a.currentTarget.id);temp=a.currentTarget.id.split("_");tableId=temp[2];$("#referral_firstname_"+tableId).html('<input type="text" name="firstName" maxlength="30" value='+$("#referral_firstname_"+tableId).html()+"></input>");$("#referral_lastname_"+tableId).html('<input type="text" name="lastName" maxlength="30" value='+$("#referral_lastname_"+tableId).html()+"></input>");$("#referral_phone_"+tableId).html('<input type="text" name="phone" maxlength="20" value='+$("#referral_phone_"+tableId).html()+"></input>");$("#referral_email_"+tableId).html('<input type="text" name="email" maxlength="50" value='+$("#referral_email_"+tableId).html()+"></input>");a='<a class="update_referral" id="update_referral_'+tableId+'">Update</a>';var b='<a class="send_referral" id="send_referral_'+tableId+'">Update and Send</a>';$("#referral_action_"+tableId).html(a+"<br />"+b)});$(document).on("click",".update_referral",function(a){doUpdateReferral(a)});$(document).on("click",".resend_noti",function(a){logging("resend referral email=>"+a.currentTarget.id,"#00F");temp=a.currentTarget.id.split("_");tableId=temp[2];$.ajax({url:resendReferralNotiPath+"/"+tableId,type:"POST",success:function(a){logging("Resend referral notification "+a.result,"#F0F")}})});$(document).on("click",".send_referral",function(a){doSendReferral(a)});$(document).on("terms_agree","#popupContainer",function(){logging("terms agree")});$(document).on("terms_decline","#popupContainer",function(){logging("terms decline")});$(document).on("click","#remove_from_cart_bybid",function(){logging("remove_from_cart_bybid"+$(this).attr("data"));delete_from_cart_by_board_id($(this).attr("data"))});$(document).on("click","#logout",function(){logging("LOGOUT");logout()})});function initRaty(){logging("init raty");$(".readonly").toArray();$(".rating").raty({path:appConfig.ratyImgPath,cancel:!0,space:!0,width:"150px",click:function(a){var b=$(this).attr("id");$("#"+b+"_value").html(a);$("[name="+b+"]").val(a)}});$(".readonly").raty({path:appConfig.ratyImgPath,cancel:!0,space:!0,width:"155px",readOnly:!0});$(".partial_rating").raty({path:appConfig.ratyImgPath,cancel:!0,space:!0,width:"150px",click:function(a){var b=$(this).attr("id");logging("raty item=>"+b);$("#"+b+"_value").html(a);$("[name="+b+"]").val(a);a=b.split("_");for(var b=$("#group_"+a[1]+" .item").size()-1,c=0,d=0,d=1;d<=b;d++)c=""==$("#"+a[0]+"_"+a[1]+"_"+d+"_q_value").html()?c+0:c+parseInt($("#"+a[0]+"_"+a[1]+"_"+d+"_q_value").html()),c=""==$("#"+a[0]+"_"+a[1]+"_"+d+"_p_value").html()?c+0:c+parseInt($("#"+a[0]+"_"+a[1]+"_"+d+"_p_value").html()),c=""==$("#"+a[0]+"_"+a[1]+"_"+d+"_r_value").html()?c+0:c+parseInt($("#"+a[0]+"_"+a[1]+"_"+d+"_r_value").html()),c=""==$("#"+a[0]+"_"+a[1]+"_"+d+"_c_value").html()?c+0:c+parseInt($("#"+a[0]+"_"+a[1]+"_"+d+"_c_value").html());d=(c/(4*b)).toFixed(1);$("#rate_"+a[1]+"_overall").html(d);$("#rate_"+a[1]).raty({path:appConfig.ratyImgPath,space:!0,width:"155px",readOnly:!0,half:!0,score:d});$("[name=rate_"+a[1]+"]").val(d)}})}function hashChange(){if(-1!=location.hash.search("#nail")){logging("Hash Change=>"+location.hash);var a=location.hash.split("_");showWindow(a[1]);closeSidebar()}else if(-1!=location.hash.search("#messages_page")){logging("Trigger Hash Change: messages page");var a=location.hash.split("_"),b=a[2];logging("reload message page=>"+b);a=getIdByName("tab_messages");$("#tabs").tabs("url",a,messagesPagePath+"/"+b);logging("SELECT MESSAGES");$("#tab_messages").html(layoutTemplate.basicConsoleFrame);$("#tabs").tabs("select",a);$("#tabs").tabs("load",a)}else if(-1!=location.hash.search("#message_detail")){logging("Trigger Hash Change: message detail");var a=location.hash.split("_"),b=a[2],c=a[3],d=a[4];logging("load message detail id=>"+b);a=getIdByName("tab_messages");$("#tabs").tabs("url",a,messageDetailPath+"/"+b+"/"+c+"/"+d);logging("SELECT MESSAGES");$("#tab_messages").html(layoutTemplate.basicConsoleFrame);$("#tabs").tabs("select",a);$("#tabs").tabs("load",a)}else-1!=location.hash.search("#search_page")?(a=location.hash.split("_"),b=a[2],a=a[3],c=getSearchResultByPage(b),logging("load search page=>"+b),logging("sort option=>"+a),$("#tabs").tabs("enable","tab_search_result"),$("#tabs").tabs("select","tab_search_result"),$("#tabs").tabs("disable","tab_search_criteria"),void 0!=a?sortSearchResult(a):sortSearchResult(1),searchResultProp.currentPage=b,searchResultPagin(),$("#mask").append('<div class="nextdata">'+c+"</div>"),transit("#mask"),syncMarket()):-1!=location.hash.search("#portfolio_page")?(c=getIdByName("tab_manage_portfolio"),a=location.hash.split("_"),b=a[2],a=a[3],logging("load portfolios page=>"+b+" ; forceToLoad=>"+a),$("#tabs").tabs("option","selected")==c?($("#tabs").tabs("select","tab_manage_portfolio"),portfolioProp.currentPage=b,getPortfolioItemsByPage(b,a)):($("#tabs").tabs("select","tab_manage_portfolio"),portfolioProp.currentPage=b)):-1!=location.hash.search("#board_item")?(a=location.hash.split("_"),b=a[2],logging("show board item=>"+b),closeSidebar(),buildPopup({url:boardDetailPath+"/"+b},function(){$(".popup .entity").tinyscrollbar()})):-1!=location.hash.search("#board_page")?(c=getIdByName("tab_manage_board"),a=location.hash.split("_"),d=a[2],b=a[3],a=a[4],boardProp.forceToReload=d===boardsResult.portfolioId&&!a?!1:!0,boardsResult.portfolioId=d,portfolioProp.portfolioId=d,portfolioProp.preloadPortfolioId=d,boardProp.currentPage=b,$("#tabs").tabs("url",c,boardPath+"/"+d),$("#tabs").tabs("option","selected")==c?$("#tabs").tabs("load",c):$("#tabs").tabs("select",c)):-1!=location.hash.search("#create_board")?(a=location.hash.split("_"),a=a[2],logging("show create board tab"),void 0==a?($("#tabs").tabs("select","tab_create_board"),$("#tabs").tabs("url",getIdByName("tab_create_board"),createBoardPath),$("#tabs").tabs("load",getIdByName("tab_create_board"))):($("#tabs").tabs("url",getIdByName("tab_create_board"),createBoardWithPortfolioPath+"/"+a),$("#tabs").tabs("select","tab_create_board"))):-1!=location.hash.search("#edit_board")?(a=location.hash.split("_"),a=a[2],logging("edit board=>"+a),$("#tabs").tabs("url",getIdByName("tab_create_board"),createBoardPath+"/"+a),$("#tabs").tabs("select","tab_create_board")):-1!=location.hash.search("#rating_designer")?(a=location.hash.split("_"),b=a[2],logging("rating=>"+b),$("#tabs").tabs("url",getIdByName("tab_rating"),ratingPath+"/"+b),$("#tabs").tabs("select","tab_rating")):-1!=location.hash.search("#rating_company")?(a=location.hash.split("_"),b=a[2],logging("rating=>"+b),$("#tabs").tabs("select","tab_rating")):-1!=location.hash.search("#design_wall")?(logging("PARSING HASH="+location.hash),a=location.hash.split("_"),b=a[2],c=a[3],a=a[4],d=getIdByName("tab_design_wall"),logging("PAGE_DESIGN WALL"+d),logging("URL="+appPath+"console/design_wall/"+b+"/"+c+"/"+a),$("#tabs").tabs("url",d,designWallPath+"/"+b+"/"+c+"/"+a),logging("SELECT DESIGN WALL"),$("#tabs").tabs("select",d),$("#tabs").tabs("load",d)):-1!=location.hash.search("#designer_account")?(logging("PARSING HASH="+location.hash),a=location.hash.split("_"),b=a[2],c=a[3],a=a[4],d=getIdByName("tab_account"),logging("URL="+designerAccountPath+"/"+b+"/"+c+"/"+a),$("#tabs").tabs("url",d,designerAccountPath+"/"+b+"/"+c+"/"+a),logging("SELECT DESIGNER ACCOUNT"),$("#tabs").tabs("select",d),$("#tabs").tabs("load",d)):-1!=location.hash.search("#search_criteria")?($("#tabs").tabs("enable","tab_search_criteria"),$("#tabs").tabs("select","tab_search_criteria"),$("#tabs").tabs("disable","tab_search_result")):-1!=location.hash.search("#alerts")?$("#tabs").tabs("select","tab_alerts"):-1!=location.hash.search("#shopping_cart")?($("#tabs").tabs("select","tab_shopping_cart"),$("#tabs").tabs("load",getIdByName("tab_shopping_cart"))):-1!=location.hash.search("#home")?$("#tabs").tabs("select","tab_home"):-1!=location.hash.search("#edit_company_profile")?$("#tabs").tabs("select","tab_home_edit_mode"):-1!=location.hash.search("#edit_designer_profile")?$("#tabs").tabs("select","tab_designer_home_edit_mode"):(logging("close=>"+location.hash),closePopup())}function getIdByName(a){for(var b=$("#tabs").children("div"),c=0;c<b.length;c++)if(b[c].id==a)return c;return-1}function disableChartLink(a){$("#chart_today").attr("href",chartPath+"/1");$("#chart_week").attr("href",chartPath+"/7");$("#chart_month").attr("href",chartPath+"/30");$("#chart_today").attr("style","text-decoration:underline;");$("#chart_week").attr("style","text-decoration:underlin;");$("#chart_month").attr("style","text-decoration:underlin;");$(a).removeAttr("href");$(a).attr("style","text-decoration:none;")}function initChart(a){logging("INIT CHART=>"+a);$.ajax({url:a,type:"GET",dataType:"json",beforeSend:function(){logging("Chart Loading");$("#activity_chart").html('<div style="margin-left:47%; margin-top:14%"><span style="text-align: center;"><img src="/images/spinner_small.gif" /></span></div>')},success:function(a){logging("chart success");if(!a.hasError){var c=jQuery.parseJSON(a.data),d=jQuery.parseJSON(a.ticks),g=jQuery.parseJSON(a.pointLabels);plotGraph(c,d,g);"company"==a.userType?fillCompanyGrid(a.activityGrid):fillDesignerGrid(a.activityGrid);$("#lblBoardCount").html(a.boardCount)}}})}function fillDesignerGrid(a){for(var b="",c=0,d=a.length;c<d;c++)b=a[c].showImage?b+('<tr><td class="td1"><a href="javascript:void(0)" class="gridBoardId" data='+a[c].boardId+'> <img src="/100x100/'+a[c].boardImageUrl+'"/></a></td>'):b+('<tr><td class="td1"><a href="javascript:void(0)" class="gridBoardId" data='+a[c].boardId+'> <img src="/images/forbidden.jpg"/></a></td>'),b+='<td class="td2">	 <a href="javascript:void(0)" class="gridBoardId" data='+a[c].boardId+">"+a[c].boardName+'</a></td><td class="td3">'+a[c].season+'</td><td class="td4">'+a[c].portfolioname+'</td><td class="td5">'+a[c].noofHits+'</td><td class="td6">$'+a[c].price+"</td></tr>";$("#activity_designer_grid").html("");$("#activity_designer_grid").html(b);$("#grid_scrollbar").tinyscrollbar_update()}function fillCompanyGrid(a){for(var b="",c=0,d=a.length;c<d;c++)b=a[c].showImage?b+('<tr><td class="td1"><a href="javascript:void(0)" class="gridBoardId" data='+a[c].boardId+'> <img src="/100x100/'+a[c].boardImageUrl+'"/></a></td>'):b+('<tr><td class="td1"><a href="javascript:void(0)" class="gridBoardId" data='+a[c].boardId+'> <img src="/images/forbidden.jpg"/></a></td>'),b+='<td class="td2"><a href="javascript:void(0)" class="gridBoardId" data='+a[c].boardId+">"+a[c].boardName+'</a></td><td class="td3">'+a[c].season+'</td><td class="td4"><a href="javascript:void(0)" class="gridDesignerName" data='+a[c].designerId+">"+a[c].designerName+'</a></td><td class="td5">$'+a[c].price+'</td><td class="td6">'+a[c].strDateViewed+"</td></tr>";$("#activity_company_grid").html("");$("#activity_company_grid").html(b);$("#grid_scrollbar").tinyscrollbar_update()}function plotGraph(a,b,c){$.jqplot("activity_chart",a,{title:"Viewed Boards",axesDefaults:{tickRenderer:$.jqplot.CanvasAxisTickRenderer,tickOptions:{fontSize:"10pt"}},axes:{xaxis:{renderer:$.jqplot.CategoryAxisRenderer,ticks:b,label:"Time Scale"},yaxis:{min:0,pad:1.5,tickOptions:{formatString:"%d"}}},seriesDefaults:{showMarker:!0,markerOptions:{style:"filledSquare",size:4,color:"blue"},pointLabels:{show:!0,labels:c}}}).replot()}function syncMarket(){logging("ITEM TOTAL=>"+$(".form_add_to_cart").size(),"#F00");if(void 0!=globalVars.cart)for(var a=0;a<$(".form_add_to_cart").size();a++){var b=$(".form_add_to_cart").get(a).name,b=b.split("_"),b=b[4];if(void 0!=globalVars.cart||null!=globalVars.cart)-1!=$.inArray(parseInt(b),globalVars.cart.boardIdList)?($(".form_add_to_cart").get(a).value=!0,$("#add_board_"+b).addClass("added_to_cart")):($(".form_add_to_cart").get(a).value=!1,$("#add_board_"+b).removeClass("added_to_cart"))}else logging("cart empty","#F00")}function getCart(){$.ajax({url:getItemPath,type:"POST",error:function(){logging("get cart error")},success:function(a){globalVars.cart=a;checkShoppingCart(a.count)}})}function checkShoppingCart(a){logging("COUNT=>"+a);0<a?$("#cart_icon .cart_icon").attr("src",appConfig.shoppingCartFullImgPath):$("#cart_icon .cart_icon").attr("src",appConfig.shoppingCartImgPath);$("#lblitemCount").html(a)}function moveToCart(a,b){void 0==b&&(b=!0);var c=a.split("_")[2],d=$("[name=form_add_to_cart_"+c+"]").val();"false"==d?$.ajax({url:addItemPath,type:"POST",data:"boardId="+c+"&boardprice=100&percentage0.1",success:function(a){b&&effect_addToCart(c);d="true"==d?!1:!0;$("[name=form_add_to_cart_"+c+"]").val(d);checkShoppingCart(a.count);globalVars.cart=a}}):$.ajax({url:deleteItemPath,type:"POST",data:"boardId="+c+"&boardprice=100&percentage0.1",success:function(a){effect_backToMarket(c);d="true"==d?!1:!0;$("[name=form_add_to_cart_"+c+"]").val(d);checkShoppingCart(a.count);globalVars.cart=a}})}function delete_from_cart_by_board_id(a){$.ajax({url:deleteItemPath,type:"POST",data:"boardId="+a+"&boardprice=100&percentage0.1",success:function(b){logging("delete_from_cart_by_board_id success");checkShoppingCart(b.count);globalVars.cart=b;$("#item_id_"+a).html("");$("#total_price").html("$"+b.total);syncMarket();$("#tabs").tabs("load",getIdByName("tab_shopping_cart"));0<b.count?$("#popup_checkout_button").html('<a href="javascript:void(0)" id="to_checkout"><div class="button orangeButton" id="button_checkout">Checkout</div></a>'):$("#popup_checkout_button").html("")}})}function effect_addToCart(a){var b=$("#cart_icon").offset();logging("cart:"+b.top+":"+b.left);var c="stuff_"+a+"_0";$("body").append('<div class="stuff" id="'+c+'"></div>');$("#"+c).css({opacity:1,width:150,height:150});$("#"+c).html($("#board_"+a).html());var d=$("#board_"+a).offset();logging("cart:"+d.top+":"+d.left);$("#"+c).css(d);$("#"+c).css("display","block");$("#body").css("cursor","progress");$(".add_to_cart").css("cursor","progress");$("#"+c).animate({top:b.top+8,left:b.left+50,width:0,height:0},1500,"swing",function(){$("#"+c).remove();$("#add_board_"+a).toggleClass("added_to_cart");$("#body").css("cursor","default");$(".add_to_cart").css("cursor","pointer")})}function effect_backToMarket(a){var b=$("#cart_icon").offset();b.top+=8;b.left+=50;logging("cart:"+b.top+":"+b.left);var c="stuff_"+a+"_1";$("body").append('<div class="stuff" id="'+c+'"></div>');$("#"+c).css({opacity:1,width:0,height:0});$("#"+c).html($("#board_"+a).html());$("#"+c).css("display","block");var d=$("#board_"+a).offset();logging("cart:"+d.top+":"+d.left);$("#"+c).css(b);$("#body").css("cursor","progress");$(".add_to_cart").css("cursor","progress");$("#"+c).animate({top:d.top,left:d.left,width:148,height:98},1500,"swing",function(){$("#"+c).remove();$("#add_board_"+a).toggleClass("added_to_cart");$("#body").css("cursor","default");$(".add_to_cart").css("cursor","pointer")})}function addToCart(a){$.ajax({url:addItemPath,type:"POST",data:"boardId="+a,success:function(b){checkShoppingCart(b.count);globalVars.cart=b;buildPopupMsg({content:"Added to cart successfully<br />(This popup will be closed automatically in 5 seconds)",showOk:!0,title:"Add to cart",showOverlay:!0,onShow:function(){setTimeout(function(){closePopupMsg()},5e3)}});showWindow(a,!1);syncMarket()}})}function removeFromCart(a){$.ajax({url:deleteItemPath,type:"POST",data:"boardId="+a,success:function(b){checkShoppingCart(b.count);globalVars.cart=b;buildPopupMsg({content:"Remove from cart successfully",showOk:!0,title:"Remove from cart",showOverlay:!0});showWindow(a,!1);syncMarket()}})}function showCommission(){for(var a=$("#saleTypeTable tbody").children("tr").length-1,b="-1.0",c=1;c<=a;c++)"checked"==$("#form_saletype_"+c).attr("checked")&&((b=$("#form_saletype_"+c+"_cost").val())||(b="-1.0"));closeSidebar();buildPopup({url:showCommissionPath+"/"+b})}function createBoard(a){void 0==a&&(a=!1);calculate();for(var b=$("#saleTypeTable tbody").children("tr").length-1,c="-1.0",d=1;d<=b;d++)"checked"==$("#form_saletype_"+d).attr("checked")&&((c=$("#form_saletype_"+d+"_cost").val())||(c="-1.0"));$.ajax({url:createBoardPath,type:"POST",data:$("#form_create_board").serialize()+"&price="+c,success:function(b){if(b.hasError){var c=[];$(".label").removeAttr("style");for(var d=0;d<b.errors.length;d++)c.push(b.errors[d].defaultMessage),logging("Error field=>"+b.errors[d].field);$("#overlay").fadeOut("fast");buildPopupMsg({content:"Please enter data in the mandatory fields displayed in the list:<br/>"+c.join("<br/>"),showOk:!0})}else globalVars.isChangedWithoutSubmit=!1,"create"==b.type?buildPopupMsg({content:"Create board successfully<br />(This popup will be closed automatically in 5 seconds)",showOk:!0,title:"Create board",onShow:function(){setTimeout(function(){closePopupMsg()},5e3)},onClose:function(){a?location.hash="#board_page_"+$("#form_create_board #portfolioId").val()+"_0":clear()},onOk:function(){a?location.hash="#board_page_"+$("#form_create_board #portfolioId").val()+"_0":clear()}}):buildPopupMsg({content:"Update board successfully<br />(This popup will be closed automatically in 5 seconds)",showOk:!0,title:"Update board",onShow:function(){setTimeout(function(){closePopupMsg()},5e3)},onClose:function(){a?location.hash="#board_page_"+$("#form_create_board #portfolioId").val()+"_0":($("#tabs").tabs("url",getIdByName("tab_create_board"),createBoardPath+"/"+b.boardId),$("#tabs").tabs("select","tab_create_board"))},onOk:function(){a?location.hash="#board_page_"+$("#form_create_board #portfolioId").val()+"_0":($("#tabs").tabs("url",getIdByName("tab_create_board"),createBoardPath+"/"+b.boardId),$("#tabs").tabs("select","tab_create_board"))}})}})}function calculate(){for(var a=$("#saleTypeTable tbody").children("tr"),b=1;b<=a.length-1;b++)if("checked"==$("#form_saletype_"+b).attr("checked")){var c=$("#form_saletype_"+b+"_cost").val(),d=parseFloat($("#f4g_rate").val()),c=c*(1-d);$("#saletype_"+b+"_final").html(c.toFixed(2));$("#form_final_price").val(c)}}function clear(){logging("CLEAR FORM");$("#form_create_board")[0].reset();$("#create_board_review").html("");$("#form_board_image_url").val("");$("#saleTypeTable tbody").children("tr");for(var a=1;4>=a;a++)$("#saletype_"+a).html("0000.00"),$("#saletype_"+a+"_final").html("0000.00");$("#form_final_price").val("0")}function clearSaleTypeTable(){for(var a=$("#saleTypeTable tbody").children("tr").length-1,b=1;b<=a;b++)$("#saletype_"+b).html("0000.00"),$("#saletype_"+b+"_final").html("0000.00");$("#form_final_price").val("0")}function getBoardsByPortfolioId(a){logging("Get Boards By=>"+a);$.ajax({url:getBoardsByPortfolioIdPath+"/"+a,type:"POST",beforeSend:function(){$("#board_mask").html('<div class="data">'+layoutTemplate.loadingMsg+"</div>")},success:function(b){logging("Get boards data","#F00");boardsResult.data=b.results;boardProp.totalPages=Math.ceil(b.results.length/boardProp.itemsPerPage);logging("Total board pages=>"+boardProp.totalPages);boardProp.currentPage=0;location.hash="#board_page_"+a+"_0"}})}function getBoardsByPage(a,b,c){var d="";if(null==boardsResult.data||!0===c||void 0===c)$.ajax({url:getBoardsByPortfolioIdPath+"/"+a,type:"POST",beforeSend:function(){$("#board_mask").html('<div class="data">'+layoutTemplate.loadingMsg+"</div>")},success:function(c){logging("Get boards data successfully=>"+a+" ; "+b,"#F00");boardsResult.data=c.results;boardProp.totalPages=Math.ceil(c.results.length/boardProp.itemsPerPage);logging("Total board pages=>"+boardProp.totalPages);getBoardsByPage(a,b,!1)}});else{for(c=b*boardProp.itemsPerPage;c<(b+1)*boardProp.itemsPerPage;c++){var g=boardsResult.data[c];if(void 0!=g){var f="",f=f+'<div class="item">',f=f+('<a href="#board_item_'+g.boardId+'" id="board_'+g.boardId+'" class="designerBoardLink" data="'+g.boardId+'">'),f=f+'<div class="board"><i></i>';0<g.boardImages.length&&(f+='<img src="/400x400/'+g.boardImages[g.boardImages.length-1].fileName+'" />');f+="</div>";f+="</a>";f+='<div class="detail">';f+='<div class="board_name">'+g.name+"</div>";f+='<div class="edit"><a href="#edit_board_'+g.boardId+'">Edit</a></div>';f+='<div class="price">Price $ '+g.totalPrice+"</div>";f+='<div class="delete_board" data="'+g.boardId+'"><img src="/images/recycle_bin.png" /></div>';f+='<div class="status"> '+g.boardStatus+"</div>";"Expired"!=g.boardStatus&&(f="Published"!=g.boardStatus?f+('<div class="toggleStatus togglePubstatus_board" data="'+g.boardId+'"><img src="/images/order.png" /></div>'):f+('<div class="toggleStatus toggleHidstatus_board" data="'+g.boardId+'"><img src="/images/order.png" /></div>'));f+="</div>";f+="</div>";d+=f}}0>=d.length?$("#board_mask").append('<div class="nextdata">'+layoutTemplate.emptyBoardMsg+"</div>"):$("#board_mask").append('<div class="nextdata">'+d+"</div>");boardsPagin();transit("#board_mask")}}function boardsPagin(){logging("Refresh boards pagin","#0F0");var a="";logging("cpage=>"+boardProp.currentPage);a="";boardProp.currentPage=parseInt(boardProp.currentPage);a=0==boardProp.currentPage?a+"1&nbsp;":a+('<a href="#board_page_'+portfolioProp.portfolioId+'_0">1</a>&nbsp;');2<boardProp.totalPages&&(3<=boardProp.currentPage&&(a+="...&nbsp;"),2<=boardProp.currentPage&&(a+='<a href="#board_page_'+portfolioProp.portfolioId+"_"+(boardProp.currentPage-1)+'">'+boardProp.currentPage+"</a>&nbsp;"),0!=boardProp.currentPage&&boardProp.currentPage!=boardProp.totalPages-1&&(a+=boardProp.currentPage+1+"&nbsp;"),3<=boardProp.totalPages-boardProp.currentPage&&(a+='<a href="#board_page_'+portfolioProp.portfolioId+"_"+(boardProp.currentPage+1)+'">'+(boardProp.currentPage+2)+"</a>&nbsp;"),4<=boardProp.totalPages-boardProp.currentPage&&(a+="...&nbsp;"));2<=boardProp.totalPages&&(a=boardProp.currentPage==boardProp.totalPages-1?a+(boardProp.totalPages+"&nbsp;"):a+('<a href="#board_page_'+portfolioProp.portfolioId+"_"+(boardProp.totalPages-1)+'">'+boardProp.totalPages+"</a>&nbsp;"));$("#manage_board_pagin").html("Pages:&nbsp;"+a)}function prevBoardPage(){logging("board prev");logging(portfolioProp);boardProp.currentPage--;0>boardProp.currentPage&&(boardProp.currentPage=boardProp.totalPages-1);location.hash="#board_page_"+portfolioProp.preloadPortfolioId+"_"+boardProp.currentPage}function nextBoardPage(){logging("board next");logging(portfolioProp);boardProp.currentPage++;boardProp.currentPage>=boardProp.totalPages&&(boardProp.currentPage=0);location.hash="#board_page_"+portfolioProp.preloadPortfolioId+"_"+boardProp.currentPage}function refreshBoards(){location.hash==="#board_page_"+portfolioProp.portfolioId+"_0_1"?(console.log("realod"),$(window).hashchange()):location.hash="board_page_"+portfolioProp.portfolioId+"_0_1"}function checkFileTypeAndSaleType(){var a=$('#saleTypeTable input[type="radio"]:checked').attr("code"),b=$("#form_board_image_type").val();if("ai"==b){if("JG"==a)return buildPopupMsg({content:"The file you uploaded is ai, please select the options with AI",showOk:!0,title:"File Type Inconsistent",showOverlay:!0}),!1}else if("jpg"==b&&"JG"!=a)return buildPopupMsg({content:"The file you uploaded is jpg, please select the option JPG",showOk:!0,title:"File Type Inconsistent",showOverlay:!0}),!1;return!0}function getCategoryList(a){$.ajax({cache:!1,url:categoryListPath+"/"+a,type:"GET",timeout:5e3,beforeSend:function(){$("#form_category").html(layoutTemplate.optionLoadingMsg)},error:function(a,c,d){logging("Error=>"+a+";"+c+";"+d);$("#form_category").html("")},success:function(a){logging("GET CATEGORY=>"+a.list.length);var c;if(0>=a.list.length)c="<option value=-1>--Empty--</option>";else{c=layoutTemplate.optionDefaultMsg;for(var d=0;d<a.list.length;d++)c+="<option value="+a.list[d].categoryId+">"+a.list[d].name+"</option>"}$("#form_category").html(c)},complete:function(a,c){logging("AJAX Complete=>"+a+":"+c)}})}function getProductList(a){$.ajax({cache:!1,url:productListPath+"/"+a,type:"GET",timeout:5e3,beforeSend:function(){$("#form_product").html(layoutTemplate.optionLoadingMsg)},error:function(a,c,d){logging("Error=>"+a+";"+c+";"+d);$("#form_product").html("")},success:function(a){logging("GET LEVEL=>"+a.list.length);var c;if(0>=a.list.length)c="<option value=-1>--Empty--</option>";else{c=layoutTemplate.optionDefaultMsg;for(var d=0;d<a.list.length;d++)c+="<option value="+a.list[d].categoryId+">"+a.list[d].name+"</option>"}$("#form_product").html(c)},complete:function(a,c){logging("AJAX Complete=>"+a+":"+c)}})}function getProductTypeList(a){$.ajax({cache:!1,url:productTypeListPath+"/"+a,type:"GET",timeout:5e3,beforeSend:function(){$("#form_product_type").html(layoutTemplate.optionLoadingMsg)},error:function(a,c,d){logging("Error=>"+a+";"+c+";"+d);$("#form_product_type").html("")},success:function(a){logging("GET LEVEL=>"+a.list.length);var c;if(0>=a.list.length)c="<option value=-1>--Empty--</option>";else{c=layoutTemplate.optionDefaultMsg;for(var d=0;d<a.list.length;d++)c+="<option value="+a.list[d].categoryId+">"+a.list[d].name+"</option>"}$("#form_product_type").html(c)},complete:function(a,c){logging("AJAX Complete=>"+a+":"+c)}})}function initSeasonsList(a){logging("season Path=>"+seasonYearListPath);$("#season").html("Loading Data, Please wait...");$.ajax({url:seasonYearListPath+"/"+a,type:"GET",success:function(a){a=processJSONObject(a);$("#season").tree({data:a,autoOpen:!1,dragAndDrop:!1})}})}function getSearchResult(){logging("submit");var a=$("#form_search_criteria").serialize(),a=a.replace("&division=-1",""),a=a.replace("&category=-1",""),a=a.replace("&product=-1",""),a=a.replace("&productType=-1","");logging("search form=>"+a);sessionStorage.searchCriteria=a;$.ajax({url:searchResultPath,data:a,type:"GET",beforeSend:function(){$("#searchCriteriaLoadingPanel").fadeIn(0)},success:function(a){$("#searchCriteriaLoadingPanel").fadeOut(0);!1==a.hasError?0==a.results.length?buildPopupMsg({content:"Your search did not return any results.<br/>Please redefine search criteria.",showOk:!0,title:"No search result"}):(searchResult=a.results,searchResultProp.totalPages=Math.ceil(a.results.length/searchResultProp.itemsPerPage),logging("TOTAL SEARCH ITEMS=>"+a.results.length),logging("Current Page=>"+searchResultProp.currentPage+" ; Total Pages=>"+searchResultProp.totalPages),logging("Show item from "+0*searchResultProp.itemsPerPage+" to "+((searchResultProp.currentPage+1)*searchResultProp.itemsPerPage-1)),location.hash="#search_page_0",$("#tabs").tabs("enable","tab_search_result"),$("#tabs").tabs("select","tab_search_result"),$("#tabs").tabs("disable","tab_search_criteria")):buildPopupMsg({content:"Your search did not return any results.<br/>Please redefine search criteria.",showOk:!0,title:"No search result"})}})}function getSearchResultByPage(a){var b="";if(void 0!=searchResult)for(var c=a*searchResultProp.itemsPerPage;c<(a+1)*searchResultProp.itemsPerPage;c++)if(val=searchResult[c],void 0!=val)var d="",d=d+('<div class="nail" id="item'+val.boardId+'">'),d=d+('<div class="name">'+val.name+"</div>"),d=d+('<div class="check"><div id="add_board_'+val.boardId+'" class="add_to_cart"></div><input class="form_add_to_cart" name="form_add_to_cart_'+val.boardId+'" type="hidden" value="false"/></div>'),d=d+('<a href="javascript:void(0)" class="boardLink" data="'+val.boardId+'"><div class="pic" id="board_'+val.boardId+'"><img src="/100x100/'+val.thumbnailUrl+'" style="width:auto; height:100%"/></div></a>'),d=d+'<div class="nailfunctions"></div>',d=d+('<div class="detail">&nbsp;$'+val.totalPrice+"</div>"),d=d+"</div>",b=b+d;return b}function searchResultPagin(){logging("Refresh search result pagin","#0F0");logging("cpage=>"+searchResultProp.currentPage);var a="";searchResultProp.currentPage=parseInt(searchResultProp.currentPage);a=0==searchResultProp.currentPage?a+"1&nbsp;":a+'<a href="#search_page_0">1</a>&nbsp;';2<searchResultProp.totalPages&&(3<=searchResultProp.currentPage&&(a+="...&nbsp;"),2<=searchResultProp.currentPage&&(a+='<a href="#search_page_'+(searchResultProp.currentPage-1)+'">'+searchResultProp.currentPage+"</a>&nbsp;"),0!=searchResultProp.currentPage&&searchResultProp.currentPage!=searchResultProp.totalPages-1&&(a+=searchResultProp.currentPage+1+"&nbsp;"),3<=searchResultProp.totalPages-searchResultProp.currentPage&&(a+='<a href="#search_page_'+(searchResultProp.currentPage+1)+'">'+(searchResultProp.currentPage+2)+"</a>&nbsp;"),4<=searchResultProp.totalPages-searchResultProp.currentPage&&(a+="...&nbsp;"));2<=searchResultProp.totalPages&&(a=searchResultProp.currentPage==searchResultProp.totalPages-1?a+(searchResultProp.totalPages+"&nbsp;"):a+('<a href="#search_page_'+(searchResultProp.totalPages-1)+'">'+searchResultProp.totalPages+"</a>&nbsp;"));$("#searchResultPagin .pages").html('<span style="font-weight: bold;">Pages:</span>'+a)}function sortSearchResult(a){if(basicConfig.enableSorting){switch(a){case"1":logging("Sort by date ASC");searchResult.sort(function(a,c){return c.date>a.date?-1:1});break;case"2":logging("Sort by date DESC");searchResult.sort(function(a,c){return c.date>a.date?1:-1});break;case"3":logging("Sort by Designer ASC");searchResult.sort(function(a,c){return c.designerName.toUpperCase()>a.designerName.toUpperCase()?-1:1});break;case"4":logging("Sort by Designer DESC");searchResult.sort(function(a,c){return c.designerName.toUpperCase()>a.designerName.toUpperCase()?1:-1});break;case"5":logging("Sort by Board Name ASC");searchResult.sort(function(a,c){return c.name.toUpperCase()>a.name.toUpperCase()?-1:1});break;case"6":logging("Sort by Board Name DESC");searchResult.sort(function(a,c){return c.name.toUpperCase()>a.name.toUpperCase()?1:-1});break;default:logging("Sorting what?")}searchResultPagin();$("#mask").append('<div class="nextdata">'+getSearchResultByPage(0)+"</div>");transit("#mask");syncMarket()}}function createPortfolio(){var a=CheckCreatePortfolioInput();0==a.length?$.ajax({url:createPortfolioPath,type:"POST",data:$("#form_create_portfolio").serialize(),success:function(a){logging("ERROR=>"+a.hasError);if(a.hasError){var c=[];$(".label").removeAttr("style");for(var d=0;d<a.errors.length;d++)c.push(a.errors[d].defaultMessage),logging("Error field=>"+a.errors[d].field);$("#overlay").fadeOut("fast");buildPopupMsg({content:"Please enter data in the mandatory fields displayed in the list:<br/>"+c.join("<br/>"),showOk:!0})
}else buildPopupMsg({content:"Added successfully<br />(This window will be closed automatically in 5 seconds)",showOk:!0,title:"Result",onShow:function(){window.setTimeout(function(){closePopupMsg()},5e3)}}),$("#form_create_portfolio")[0].reset(),globalVars.isChangedWithoutSubmit=!1,$("#tabs").tabs("load",getIdByName("tab_manage_portfolio"))}}):buildPopupMsg({content:"The fields need to be enter in the following fields which are already highlighted in correspond fields:<br/>"+a.join("<br/>"),showOk:!0})}function getPortfolioItems(a){void 0==a&&(a=0);$.ajax({async:!0,url:getPortfolioItemsPath,type:"GET",timeout:3e3,beforeSend:function(){logging("beforeSend: get portfolio items");$("#portfolio_mask").html('<div class="data">'+layoutTemplate.loadingMsg+"</div>")},error:function(){logging("Get portfolio items error")},success:function(b){b.hasError?logging("GET portfolio error"):(logging("GET portfolio successfully"),portfolioResult.data=b.results,portfolioResult.imageList=b.imagesList,portfolioProp.totalPages=Math.ceil(b.results.length/portfolioProp.itemsPerPage),logging("TOTAL Portfolio items=>"+b.results.length),0<b.results.length?(logging("Total Pages=>"+portfolioProp.totalPages),getPortfolioItemsByPage(a,!1)):($("#portfolio_mask").append('<div class="nextdata">'+layoutTemplate.emptyPortfolioMsg+"</div>"),transit("#portfolio_mask")))},complete:function(){logging("Get portfolio items complete")}})}function getPortfolioItemsByPage(a,b){logging("portfolio items per page=>"+portfolioProp.itemsPerPage);logging("SHOW portfolio item from "+a*portfolioProp.itemsPerPage+" to "+(a+1)*portfolioProp.itemsPerPage);var c="";if(null!=portfolioResult.data&&null!=portfolioResult.imageList&&(!1==b||void 0==b)){if(portfolioProp.totalPages==a)c=layoutTemplate.emptyPage;else{a=parseInt(a);for(var d=a*portfolioProp.itemsPerPage;d<(a+1)*portfolioProp.itemsPerPage;d++){var g=portfolioResult.data[d],f=portfolioResult.imageList[d],e="";void 0!=g&&(e+='<div class="item">',e+='<a href="javascript:void(0);" id="portfolio_'+g.portfolioId+'" data="'+g.portfolioId+'"">',e+='<div class="portfolio">',e+="<table>",e+="<tr>",e+="<td>",void 0!=f[0]&&(e+="<img src=/100x100/"+f[0]+">"),e+="</td>",e+="<td>",void 0!=f[1]&&(e+="<img src=/100x100/"+f[1]+">"),e+="</td>",e+="</tr>",e+="<tr>",e+="<td>",void 0!=f[2]&&(e+="<img src=/100x100/"+f[2]+">"),e+="</td>",e+="<td>",void 0!=f[3]&&(e+="<img src=/100x100/"+f[3]+">"),e+="</td>",e+="<tr>",e+="</table>",e+="</div>",e+="</a>",e+='<div class="detail">',e+='<div class="name">'+g.name+"</div>",e+='<div class="checkbox delete_portfolio" data="'+g.portfolioId+'"><img src="/images/recycle_bin.png" /></div>',e+="</div>",e+="</div>");c+=e}}portfolioPagin();$("#portfolio_mask").append('<div class="nextdata">'+c+"</div>");transit("#portfolio_mask")}else logging("Reload the portfolio items=>"+a),getPortfolioItems(a)}function portfolioPagin(){logging("Refresh portfolio pagin","#0F0");logging("cpage=>"+portfolioProp.currentPage);var a="";portfolioProp.currentPage=parseInt(portfolioProp.currentPage);a=0==portfolioProp.currentPage?a+"1&nbsp;":a+'<a href="#portfolio_page_0_0">1</a>&nbsp;';2<portfolioProp.totalPages&&(3<=portfolioProp.currentPage&&(a+="...&nbsp;"),2<=portfolioProp.currentPage&&(a+='<a href="#portfolio_page_'+(portfolioProp.currentPage-1)+'_0">'+portfolioProp.currentPage+"</a>&nbsp;"),0!=portfolioProp.currentPage&&portfolioProp.currentPage!=portfolioProp.totalPages-1&&(a+=portfolioProp.currentPage+1+"&nbsp;"),3<=portfolioProp.totalPages-portfolioProp.currentPage&&(a+='<a href="#portfolio_page_'+(portfolioProp.currentPage+1)+'_0">'+(portfolioProp.currentPage+2)+"</a>&nbsp;"),4<=portfolioProp.totalPages-portfolioProp.currentPage&&(a+="...&nbsp;"));2<=portfolioProp.totalPages&&(a=portfolioProp.currentPage==portfolioProp.totalPages-1?a+(portfolioProp.totalPages+"&nbsp;"):a+('<a href="#portfolio_page_'+(portfolioProp.totalPages-1)+'_0">'+portfolioProp.totalPages+"</a>&nbsp;"));$("#manage_portfolio_pagin").html("Pages:&nbsp;"+a)}function initIdleTimeoutPlugin(){logging("Init idle timeout plugin");$.idleTimeout("#session_expire","#continueSession",{idleAfter:idleTimerConfig.idleTime,pollingInterval:idleTimerConfig.pollingTime,keepAliveURL:keepSessionAlivePath,serverResponseEquals:"OK",warningLength:idleTimerConfig.warningTime,failedRequests:5,AJAXTimeout:2500,debugMode:idleTimerConfig.idleTimeoutDebugMode,onTimeout:function(){isChangedWithoutSubmitOnPopup=globalVars.isChangedWithoutSubmit=!1;window.location=logoutPath},onIdle:function(){$.browser.msie&&"8.0"==$.browser.version&&$("#session_overlay").css("filter","alpha(opacity=70)");$("#session_overlay").fadeIn("fast");showPopup({container:"#session_expire"})},onCountdown:function(a){$("#dialog-countdown").html(a)},onResume:function(){logging("On Resume");closePopup("#session_expire","#session_overlay")},onAbort:function(){logging("idle timer send request abort","#F00");window.location=loginPath},onRedirect:function(){logging("idle timer redirect to login","#F00");window.location=loginPath}})}function logout(){$.idleTimeout.options.onTimeout.call(this)}function init_raty_activity(){for(var a=$("#ratingDetails .readonly").toArray(),b=0;b<a.length;b++)logging("SET RATY"+$("#"+a[b].id+"_value").html()),$("#"+a[b].id).raty({path:appConfig.ratyImgPath,space:!0,width:"100px",readOnly:!0,score:$("#"+a[b].id+"_value").html()})}function transit(a){a=$(a).children("div");globalVars.inTransit=!globalVars.inTransit;a.eq(0).animate({left:-900},"normal","swing");a.eq(1).animate({left:0},"normal","swing",function(){globalVars.inTransit=!globalVars.inTransit});a.eq(0).remove()}function openSidebar(){$.ajax({url:sidebarPath,beforeSend:function(){logging("send sidebar content req")},success:function(a){logging("load sidebar content success");$("#sidebarContent").html(a)}});globalVars.isSidebarOpened||($("#sidebar").animate({width:350},"slow",function(){$("#sidebarToggle img").attr("src","/images/arrow_right.png");$("#sidebarContent").fadeIn("fast",function(){logging("init scroll bar","#F00");$("#sidebar_scrollbar").tinyscrollbar()})}),globalVars.isSidebarOpened=!0)}function closeSidebar(){globalVars.isSidebarOpened&&($("#sidebarContent").fadeOut("fast",function(){$("#sidebar").animate({width:50},"slow",function(){$("#sidebarToggle img").attr("src","/images/arrow_left.png")})}),globalVars.isSidebarOpened=!1)}function showWindow(a,b){void 0==b&&(b=!0);closeSidebar();buildPopup({url:boardDetailPath+"/"+a,showPopup:b},function(){$(".popup .entity").tinyscrollbar()})}function showEnlargeImage(a){logging("Types of object=>"+typeof a);var b,c,d,g=screen.width,f=screen.height;"object"===typeof a?(logging("Enlarge image=>"+a.attr("image-width")+";"+a.attr("image-height")+";"+a.attr("image-data"),"#F00"),b=a.attr("image-data"),c=parseInt(a.attr("image-width")),c+=20,d=parseInt(a.attr("image-height")),d+=20,c>=.9*g&&(c=.9*g),d>=.85*f&&(d=.85*f),window.open(imageViewerPath+"?img="+b,"_blank","width="+c+",height="+d+",scrollbars=yes,toolbar=no,location=0")):(b=a,$.ajax({url:imageSizeRetrieverPath+"?img="+b,beforeSend:function(){},error:function(){},success:function(a){c=parseInt(a.imageWidth);d=parseInt(a.imageHeight);c+=20;d+=20;c>=.9*g&&(c=.9*g);d>=.85*f&&(d=.85*f);window.open(imageViewerPath+"?img="+b,"_blank","width="+c+",height="+d+",scrollbars=yes,toolbar=no,location=0")},complete:function(a,b){logging("popup complete"+a+";"+b)}}))}function sendMessage(){var a=$("#form_comment_messageBody").val(),a=a.replace(" ","");logging("MSG=>"+a.replace(" ",""));""!=a?(logging("MESSAGE DATA=>"+$("#form_comment").serialize()),$("#commentBody").val(toHtmlFormat($("#form_comment_messageBody").val())),$.ajax({url:sendMessagePath,type:"POST",data:$("#form_comment").serialize(),success:function(a){a.hasError?$("#send_status").html("Error, please resend again"):(isChangedWithoutSubmitOnPopup=!1,$("#send_status").html("Sent successfully"),$("#form_comment_messageBody").val(""))}})):logging("empty message")}function sendMessageInMessageDetail(){var a=$("#messageContent").val(),a=a.replace(" ","");logging("MSG=>"+a.replace(" ",""));""!=a&&(logging("REPLY MESSAGE DATA=>"+$("#replyForm").serialize()),$("#messageBody").val(toHtmlFormat($("#messageContent").val())),a=$("#replyForm").serialize(),logging("Data=>"+a),$.ajax({url:sendMessagePath,type:"POST",data:a,beforeSend:function(){$("#sendMessage").html('<span style="color:#0000CC">Sending...</span>')},success:function(a){a.hasError?buildPopupMsg({content:"Error, please resend again",showOk:!0,title:"Error"}):($("#send_status").html("Sent successfully"),a=getIdByName("tab_messages"),globalVars.isChangedWithoutSubmit=!1,$("#tabs").tabs("load",a))}}))}function toHtmlFormat(a){var b="",b=a.replace(/\n/g,"<br/>");return b=b.replace(/\s/g,"&nbsp;")}function wrapMessageDetail(a){void 0==a&&(a=0);for(var b=$(".viewarea").toArray();a<b.length;a++)56<$($(b[a]).children(".context")).height()&&$(b[a]).after('<div class="readMore"><a href="javascript:void(0)">Read more...</a></div>');$("#message_content_scrollbar").tinyscrollbar_update("relative")}function displayLatestTermAndConditions(a){$.ajax({url:a,type:"GET",beforeSend:function(){logging("loading "+a);$.browser.msie&&"8.0"==$.browser.version&&$("#overlay").css("filter","alpha(opacity=70)");$("#overlay").fadeIn("fast")},error:function(){$("#overlay").fadeOut("fast")},success:function(a){if(!a||!a.hasError)$("#popupContainer").html(a),showPopup()},complete:function(){$("#termScrollbar").tinyscrollbar()}})}function processJSONObject(a){a=eval(a);void 0==a[a.length-1]&&a.pop();for(var b=0;b<a.length;b++)void 0==a[b].children[a[b].children.length-1]&&a[b].children.pop();return a}function resize(){x=$("#tabs").offset();var a=x.top+$("#tabs").height();logging("size of tabs=>"+x.top+" : tabs=>"+$("#tabs").height());$("#footer").animate({top:a},"fast")}function logging(a,b){void 0==b&&(b="#000");basicConfig.debugMode&&($("#debug").css("display","block"),(void 0==a||""==a)&&$("#debug").append("Undefined or blank <br />"),$("#debug").append('<span style="color:'+b+'">'+a+"</span><br />"),basicConfig.writeLogToConsole&&console.log(a),$("#debug").scrollTop($("#debug")[0].scrollHeight))}function doSaveDesigner(){var a=CheckDesignerInput();0==a.length?(logging("save designer"),logging("FORM DATA=>"+$("#form_edit_profile").serialize()),a=$("#form_edit_profile").attr("action"),$.ajax({url:a,type:"POST",data:$("#form_edit_profile").serialize(),success:function(a){logging(a.hasError+a.errorCode+a.errorDescription);if(!1==a.hasError)globalVars.isChangedWithoutSubmit=!1,$("#userFirstName").html(a.userFirstName),$("#userLastName").html(a.userLastName),$(".bannerLogo").html('<i></i><img src="'+a.userLogo+'" />'),buildPopupMsg({content:"Update Successfully<br />(This popup will be close automatically in 5 seconds)",showOk:!0,title:"Update Profile",onShow:function(){setTimeout(function(){closePopupMsg()},5e3)},onClose:function(){location.assign(homepage+"#home")},onOk:function(){location.assign(homepage+"#home")}});else{var c=[];$(".label").removeAttr("style");for(var d=0;d<a.errors.length;d++)c.push(a.errors[d].defaultMessage),logging("Error field=>"+a.errors[d].field);$("#overlay").fadeOut("fast");buildPopupMsg({content:"Please enter data in the mandatory fields displayed in the list:<br/>"+c.join("<br/>"),showOk:!0})}}})):buildPopupMsg({content:"The fields need to be enter in the following fields which are already highlighted in correspond fields:<br/>"+a.join("<br/>"),showOk:!0})}function CheckDesignerInput(){var a=[],a=CheckforNull("#firstName",a,"#label_first_name","Please enter First Name"),a=CheckforNull("#lastName",a,"#label_last_name","Please enter Last Name"),a=CheckforNull("#address1",a,"#label_address_1","Please enter Street Address 1"),a=CheckforNull("#city",a,"#label_city","Please enter City"),a=CheckforNull("#form_state",a,"#label_state","Please enter State"),a=CheckforNullandNumber("#zip",a,"#label_zipcode","Please enter Zip Code"),a=CheckforNull("#form_country",a,"#label_country","Please enter Country"),a=CheckforNullandPhoneNumber("#cellPhone",a,"#label_cell_phone","Cell Phone Number"),a=CheckforNullandPhoneNumber("#phone_no",a,"#label_phone","Work Phone Number"),a=CheckforNullinSelect("#form_languages",a,"#label_Languages","Please select at least 1 language"),a=CheckforNullinSelect("#form_skills",a,"#label_skills","Please select at least 1 skill"),a=CheckforNull("#website",a,"#label_website","Please enter Website");return a=CheckforNull("#companyName",a,"#label_companyname","Please enter Company Name")}function doSaveCompany(){var a=CheckCompanyInput();0==a.length?(logging("save company"),logging("FORM DATA=>"+$("#form_edit_profile").serialize()),a=$("#form_edit_profile").attr("action"),$.ajax({url:a,type:"POST",data:$("#form_edit_profile").serialize(),success:function(a){logging(a);logging(a.hasError+a.errorCode+a.errorDescription);if(!1==a.hasError)globalVars.isChangedWithoutSubmit=!1,$("#userFirstName").html(a.userFirstName),$("#userLastName").html(a.userLastName),$(".bannerLogo").html('<i></i><img src="'+a.userLogo+'" />'),buildPopupMsg({content:"Update Successfully<br />(This popup will be closed automatically in 5 seconds)",showOk:!0,title:"Update Profile",onShow:function(){setTimeout(function(){closePopupMsg()},5e3)},onClose:function(){location.assign(homepage+"#home")},onOk:function(){location.assign(homepage+"#home")}});else{var c=[];$(".label").removeAttr("style");for(var d=0;d<a.errors.length;d++)c.push(a.errors[d].defaultMessage),logging("Error field=>"+a.errors[d].field);$("#overlay").fadeOut("fast");buildPopupMsg({content:"Please enter data in the mandatory fields displayed in the list:<br/>"+c.join("<br/>"),showOk:!0})}}})):buildPopupMsg({content:"The fields need to be enter in the following fields which are already highlighted in correspond fields:<br/>"+a.join("<br/>"),showOk:!0})}function CheckCompanyInput(){var a=[],a=CheckforNull("#first_name",a,"#label_first_name","Please enter First Name"),a=CheckforNull("#last_name",a,"#label_last_name","Please enter Last Name"),a=CheckforNull("#company_name",a,"#label_company_name","Please enter Company Name"),a=CheckforNull("#address_1",a,"#label_address_1","Please enter Street Address 1"),a=CheckforNull("#city",a,"#label_city","Please enter City"),a=CheckforNullandNumber("#zipcode",a,"#label_zipcode","Please enter Zip Code"),a=CheckforNull("#form_state",a,"#label_state","Please enter State"),a=CheckforNull("#form_country",a,"#label_country","Please enter Country"),a=CheckforNullandPhoneNumber("#cell_phone",a,"#label_cell_phone","Cell Phone Number"),a=CheckforNullandPhoneNumber("#phone_no",a,"#label_phone","Work Phone Number");return a=CheckforNull("#website",a,"#label_website","Please enter Website")}function CheckCreatePortfolioInput(){var a=[],a=CheckforNull("#form_name_of_portfolio",a,"#label_portfolio_name","Please enter Portfolio Name"),a=CheckforNull("#form_description_of_portfolio",a,"#label_portfolio_description","Please enter Portfolio Description"),a=CheckforNegative("#form_division",a,"#label_division","Please enter Division");return a=CheckforNegative("#form_category",a,"#label_category","Please enter Category")}function doUpdateReferral(a){var b=CheckUpdateReferralInput(a);0==b.length?(logging("update referral=>"+a.currentTarget.id),temp=a.currentTarget.id.split("_"),tableId=temp[2],$("#form_referral_id").val(tableId),$("#form_referral_firstname").val($("#referral_firstname_"+tableId+" input").val()),$("#form_referral_lastname").val($("#referral_lastname_"+tableId+" input").val()),$("#form_referral_phone").val($("#referral_phone_"+tableId+" input").val()),$("#form_referral_email").val($("#referral_email_"+tableId+" input").val()),logging($("#form_referral").serialize()),$.ajax({url:updateReferralPath+"/0/"+tableId,type:"POST",data:$("#form_referral").serialize(),success:function(a){logging("Send referral data success");logging("update referral result=>"+a,"#F00");if(a.hasError||null==a)logging("Update Referral Error","#F00"),buildPopupMsg({content:"Update Failure.<br /> Please click update again.",showOk:!0,title:"Update Referral Error"});else{isChangedWithoutSubmitOnPopup=!1;logging("Result"+a.result.firstName,"#0F0");logging("Result"+a.result.lastName,"#0F0");logging("Result"+a.result.phone,"#0F0");logging("Result"+a.result.email,"#0F0");$("#referral_firstname_"+tableId).html(a.result.firstName);$("#referral_lastname_"+tableId).html(a.result.lastName);$("#referral_phone_"+tableId).html(a.result.phone);$("#referral_email_"+tableId).html(a.result.email);a='<a href="javascript:void(0)" class="resend_noti" id="resend_referral_'+tableId+'">Resend</a>';var b='<a href="javascript:void(0)" class="edit_referral" id="edit_referral_'+tableId+'">Edit</a>';$("#referral_action_"+tableId).html(a+"<br />"+b)}}})):buildPopupMsg({content:"The fields need to be enter in the following fields which are already highlighted in correspond fields:<br/>"+b.join("<br/>"),showOk:!0})}function CheckUpdateReferralInput(a){var b=[];temp=a.currentTarget.id.split("_");tableId=temp[2];""==$("#referral_firstname_"+tableId+" input").val()&&b.push("Please Enter First Name");""==$("#referral_lastname_"+tableId+" input").val()&&b.push("Please Enter Last Name");""==$("#referral_email_"+tableId+" input").val()&&b.push("Please Enter Email");return b}function doSendReferral(a){var b=CheckUpdateReferralInput(a);0==b.length?(logging("send referral=>"+a.currentTarget.id),logging("update referral=>"+a.currentTarget.id),temp=a.currentTarget.id.split("_"),tableId=temp[2],$("#form_referral_id").val(tableId),$("#form_referral_firstname").val($("#referral_firstname_"+tableId+" input").val()),$("#form_referral_lastname").val($("#referral_lastname_"+tableId+" input").val()),$("#form_referral_phone").val($("#referral_phone_"+tableId+" input").val()),$("#form_referral_email").val($("#referral_email_"+tableId+" input").val()),logging($("#form_referral").serialize()),$.ajax({url:updateReferralPath+"/1/"+tableId,type:"POST",data:$("#form_referral").serialize(),success:function(a){logging("Send referral data success");logging("update referral result=>"+a,"#F00");if(a.hasError||null==a)logging("Update Referral Error","#F00"),buildPopupMsg({content:"Update Failure.<br /> Please click update again.",showOk:!0,title:"Update Referral Error"});else{isChangedWithoutSubmitOnPopup=!1;logging("Result"+a.result.firstName,"#0F0");logging("Result"+a.result.lastName,"#0F0");logging("Result"+a.result.phone,"#0F0");logging("Result"+a.result.email,"#0F0");$("#referral_firstname_"+tableId).html(a.result.firstName);$("#referral_lastname_"+tableId).html(a.result.lastName);$("#referral_phone_"+tableId).html(a.result.phone);$("#referral_email_"+tableId).html(a.result.email);a='<a href="javascript:void(0)" class="resend_noti" id="resend_referral_'+tableId+'">Resend</a>';var b='<a href="javascript:void(0)" class="edit_referral" id="edit_referral_'+tableId+'">Edit</a>';$("#referral_action_"+tableId).html(a+"<br />"+b)}}})):buildPopupMsg({content:"The fields need to be enter in the following fields which are already highlighted in correspond fields:<br/>"+b.join("<br/>"),showOk:!0})}function createBoardInputChecking(){var a=[],b=$("#saleTypeTable tbody").children("tr").length-1;$("#create_board .detail span").removeAttr("style");$("#label_upload_image").html("");for(var a=CheckforNull("#form_board_name",a,"#label_board_name","Please enter Board Name"),a=CheckforNull("#form_board_description",a,"#label_description","Please enter Board Description"),a=CheckforNull("#portfolioId",a,"#label_portfolio","Please Select a portfolio or create a new portfolio"),a=CheckforNull("#product",a,"#label_product","Please enter Product"),a=CheckforNull("#productType",a,"#label_product_type","Please enter Product Type"),c=!1,d=1;d<=b;d++)"checked"==$("#form_saletype_"+d).attr("checked")&&(c=!0);!1==c&&(a=HighlightLabelandPushError(a,"#label_sale_type","Please Select one sale type"));c=!1;for(d=1;d<=b;d++)void 0!=$("#form_saletype_"+d+"_cost").val()&&""!=$("#form_saletype_"+d+"_cost").val()&&0<$("#form_saletype_"+d+"_cost").val()&&10001>$("#form_saletype_"+d+"_cost").val()&&(c=!0);!1==c&&(a=HighlightLabelandPushError(a,"#label_pricing","Please enter a valid price. It should be between 0 and 10000"));return a=CheckforNullPushtoElement("#form_board_image_url",a,"#label_upload_image","Please upload Board Image")}function deleteBoard(a){$.ajax({url:deleteBoardPath+"/"+a,type:"GET",success:function(a){logging("delete board result");a.hasError?logging("ERROR OCCURED"):(logging("REFRESH BOARDS"),$("body").trigger("refresh_board",[portfolioProp.portfolioId]))}})}function ToggleStatusBoard(a){$.ajax({url:toggleStatusBoardPath+"/"+a,type:"GET",success:function(a){logging("Toggle Status board result");a.hasError?logging("ERROR OCCURED"):(logging("REFRESH BOARDS"),$("body").trigger("refresh_board",[portfolioProp.portfolioId]))}})}function deletePortfolio(a){$.ajax({url:deletePortfolioPath+"/"+a,type:"GET",success:function(a){a.hasError?logging("ERROR OCCURED"):(logging("Delete Portfolio Result=>"+a),location.hash="#portfolio_page_"+portfolioProp.currentPage+"_1")}})}function checkSession(){logging("check session");$.ajax({url:keepSessionAlivePath,success:function(a){"OK"==a?logging("session still there","#F00"):"true"==$("#sessionTimeout",$(a)).val()&&(logging("session time out","#F00"),window.location=loginPath)}})}