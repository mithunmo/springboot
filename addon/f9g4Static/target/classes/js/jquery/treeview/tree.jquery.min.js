(function(){var g,C,w,q,m,z,j,A,B,x,D=[].slice,E={}.hasOwnProperty,s=function(a,b){function c(){this.constructor=a}for(var f in b)E.call(b,f)&&(a[f]=b[f]);c.prototype=b.prototype;a.prototype=new c;a.__super__=b.prototype;return a};g=this.jQuery;var p=function(a,b){this.$el=g(a);this.options=g.extend({},this.defaults,b);this._init()};p.name="SimpleWidget";p.prototype.defaults={};p.prototype.destroy=function(){return this._deinit()};p.prototype._init=function(){return null};p.prototype._deinit=function(){return null};p.register=function(a,b){var c,f,l,e;e=function(){return"simple_widget_"+b};f=function(b,c){var f;f=e();b.each(function(){var b;b=new a(this,c);if(!g.data(this,f))return g.data(this,f,b)});return b};l=function(a){var b;b=e();return a.each(function(){var a;(a=g.data(this,b))&&a instanceof p&&a.destroy();return g.removeData(this,b)})};c=function(a,b,c){var f;f=null;a.each(function(){var a,l;if((a=g.data(this,e()))&&a instanceof p)if((l=a[b])&&"function"===typeof l)return f=l.apply(a,c)});return f};return g.fn[b]=function(){var a,b;b=arguments[0];a=2<=arguments.length?D.call(arguments,1):[];if(void 0===b||"object"===typeof b)return f(this,b);if("string"===typeof b&&"_"!==b[0])return"destroy"===b?l(this):c(this,b,a)}};this.SimpleWidget=p;var n=function(){return n.__super__.constructor.apply(this,arguments)};s(n,p);n.name="MouseWidget";n.is_mouse_handled=!1;n.prototype._init=function(){this.$el.bind("mousedown.mousewidget",g.proxy(this._mouseDown,this));return this.is_mouse_started=!1};n.prototype._deinit=function(){var a;this.$el.unbind("mousedown.mousewidget");a=g(document);a.unbind("mousemove.mousewidget");return a.unbind("mouseup.mousewidget")};n.prototype._mouseDown=function(a){var b;if(!n.is_mouse_handled&&(this.is_mouse_started||this._mouseUp(a),1===a.which&&this._mouseCapture(a)))return this.mouse_down_event=a,b=g(document),b.bind("mousemove.mousewidget",g.proxy(this._mouseMove,this)),b.bind("mouseup.mousewidget",g.proxy(this._mouseUp,this)),a.preventDefault(),this.is_mouse_handled=!0};n.prototype._mouseMove=function(a){if(this.is_mouse_started)return this._mouseDrag(a),a.preventDefault();(this.is_mouse_started=!1!==this._mouseStart(this.mouse_down_event))?this._mouseDrag(a):this._mouseUp(a);return!this.is_mouse_started};n.prototype._mouseUp=function(a){var b;b=g(document);b.unbind("mousemove.mousewidget");b.unbind("mouseup.mousewidget");this.is_mouse_started&&(this.is_mouse_started=!1,this._mouseStop(a));return!1};n.prototype._mouseCapture=function(){return!0};n.prototype._mouseStart=function(){return null};n.prototype._mouseDrag=function(){return null};n.prototype._mouseStop=function(){return null};m=n;this.Tree={};g=this.jQuery;B=function(a,b){var c,f,l,e;if(a.indexOf)return a.indexOf(b);c=l=0;for(e=a.length;l<e;c=++l)if(f=a[c],f===b)return c;return-1};this.Tree.indexOf=B;q={escapable:/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta:{"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},quote:function(a){q.escapable.lastIndex=0;return q.escapable.test(a)?'"'+a.replace(q.escapable,function(a){var c;c=q.meta[a];return"string"===typeof c?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'},str:function(a,b){var c,f,l,e,d;e=b[a];switch(typeof e){case"string":return q.quote(e);case"number":return isFinite(e)?String(e):"null";case"boolean":case"null":return String(e);case"object":if(!e)return"null";f=[];if("[object Array]"===Object.prototype.toString.apply(e)){c=l=0;for(d=e.length;l<d;c=++l)f[c]=q.str(c,e)||"null";return 0===f.length?"[]":"["+f.join(",")+"]"}for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(l=q.str(c,e))&&f.push(q.quote(c)+":"+l);return 0===f.length?"{}":"{"+f.join(",")+"}"}}};x=function(a){return q.str("",{"":a})};this.Tree.toJson=x;j={getName:function(a){return a===j.BEFORE?"before":a===j.AFTER?"after":a===j.INSIDE?"inside":"none"},BEFORE:1,AFTER:2,INSIDE:3,NONE:4};this.Tree.Position=j;var h=function(a){this.setData(a)};h.name="Node";h.prototype.setData=function(a){var b,c;if("object"!==typeof a)this.name=a;else for(b in a)c=a[b],"label"===b?this.name=c:this[b]=c;this.children=[];return this.parent=null};h.prototype.initFromData=function(a){var b,c=this;b=function(a){var b,e,d,g;d=0;for(g=a.length;d<g;d++)b=a[d],e=new h(""),e.initFromData(b),c.addChild(e);return null};c.setData(a);a.children&&b(a.children);return null};h.prototype.loadFromData=function(a){var b,c,f,d;this.children=[];f=0;for(d=a.length;f<d;f++)c=a[f],b=new h(c),this.addChild(b),"object"===typeof c&&c.children&&b.loadFromData(c.children);return null};h.prototype.addChild=function(a){this.children.push(a);return a._setParent(this)};h.prototype.addChildAtPosition=function(a,b){this.children.splice(b,0,a);return a._setParent(this)};h.prototype._setParent=function(a){this.parent=a;this.tree=a.tree;return this.tree.addNodeToIndex(this)};h.prototype.removeChild=function(a){this.children.splice(this.getChildIndex(a),1);return this.tree.removeNodeFromIndex(a)};h.prototype.getChildIndex=function(a){return g.inArray(a,this.children)};h.prototype.hasChildren=function(){return 0!==this.children.length};h.prototype.iterate=function(a){var b,c=this;b=function(f,d){var e,g,k,h,t;if(f.children){t=f.children;k=0;for(h=t.length;k<h;k++)e=t[k],g=a(e,d),c.hasChildren()&&g&&b(e,d+1);return null}};b(this,0);return null};h.prototype.moveNode=function(a,b,c){a.parent.removeChild(a);if(c===j.AFTER)return b.parent.addChildAtPosition(a,b.parent.getChildIndex(b)+1);if(c===j.BEFORE)return b.parent.addChildAtPosition(a,b.parent.getChildIndex(b));if(c===j.INSIDE)return b.addChildAtPosition(a,0)};h.prototype.getData=function(){var a;a=function(b){var c,f,d,e,g,k,h;c=[];k=0;for(h=b.length;k<h;k++){d=b[k];e={};for(f in d)g=d[f],"parent"!==f&&"children"!==f&&"element"!==f&&"tree"!==f&&Object.prototype.hasOwnProperty.call(d,f)&&(e[f]=g);d.hasChildren()&&(e.children=a(d.children));c.push(e)}return c};return a(this.children)};h.prototype.getNodeByName=function(a){var b;b=null;this.iterate(function(c){return c.name===a?(b=c,!1):!0});return b};h.prototype.addAfter=function(a){var b;return this.parent?(b=new h(a),a=this.parent.getChildIndex(this),this.parent.addChildAtPosition(b,a+1),b):null};h.prototype.addBefore=function(a){var b;return this.parent?(b=new h(a),a=this.parent.getChildIndex(this),this.parent.addChildAtPosition(b,a)):null};h.prototype.addParent=function(a){var b,c,f,d,e;if(this.parent){b=new h(a);b._setParent(this.tree);c=this.parent;e=c.children;f=0;for(d=e.length;f<d;f++)a=e[f],b.addChild(a);c.children=[];c.addChild(b);return b}return null};h.prototype.remove=function(){if(this.parent)return this.parent.removeChild(this),this.parent=null};h.prototype.append=function(a){a=new h(a);this.addChild(a);return a};h.prototype.prepend=function(a){a=new h(a);this.addChildAtPosition(a,0);return a};var v=function(a){v.__super__.constructor.call(this,a,null,!0);this.id_mapping={};this.tree=this};s(v,h);v.name="Tree";v.prototype.getNodeById=function(a){return this.id_mapping[a]};v.prototype.addNodeToIndex=function(a){if(a.id)return this.id_mapping[a.id]=a};v.prototype.removeNodeFromIndex=function(a){if(a.id)return delete this.id_mapping[a.id]};A=v;this.Tree.Tree=A;var d=function(){return d.__super__.constructor.apply(this,arguments)};s(d,m);d.name="JqTreeWidget";d.prototype.defaults={autoOpen:!1,saveState:!1,dragAndDrop:!1,selectable:!1,onCanSelectNode:null,onSetStateFromStorage:null,onGetStateFromStorage:null,onCreateLi:null,onIsMoveHandle:null,onCanMove:null,onCanMoveTo:null};d.prototype.toggle=function(a){a.hasChildren()&&new w(a,this.element).toggle();if(this.options.saveState)return this._saveState()};d.prototype.getTree=function(){return this.tree};d.prototype.selectNode=function(a,b){var c;if(this.options.selectable){this.selected_node&&this._getNodeElementForNode(this.selected_node).deselect();if(a&&(this._getNodeElementForNode(a).select(),this.selected_node=a,b))for(c=this.selected_node.parent;c;)c.is_open||this.openNode(c,!0),c=c.parent;if(this.options.saveState)return this._saveState()}};d.prototype.getSelectedNode=function(){return this.selected_node||!1};d.prototype.toJson=function(){return x(this.tree.getData())};d.prototype.loadData=function(a,b){var c,f,d,e;if(b){c=new h("");c._setParent(b.tree);c.loadFromData(a);e=c.children;f=0;for(d=e.length;f<d;f++)c=e[f],b.addChild(c);this._refreshElements(b.parent)}else this._initTree(a);if(this.is_dragging)return this._refreshHitAreas()};d.prototype.getNodeById=function(a){return this.tree.getNodeById(a)};d.prototype.getNodeByName=function(a){return this.tree.getNodeByName(a)};d.prototype.openNode=function(a,b){if(a.hasChildren()&&(new w(a,this.element).open(null,b),this.options.saveState))return this._saveState()};d.prototype.closeNode=function(a,b){if(a.hasChildren()&&(new w(a,this.element).close(b),this.options.saveState))return this._saveState()};d.prototype.isDragging=function(){return this.is_dragging};d.prototype.refreshHitAreas=function(){return this._refreshHitAreas()};d.prototype.addNodeAfter=function(a,b){var c;c=b.addAfter(a);this._refreshElements(b.parent);return c};d.prototype.addNodeBefore=function(a,b){var c;c=b.addBefore(a);this._refreshElements(b.parent);return c};d.prototype.addParentNode=function(a,b){var c;c=b.addParent(a);this._refreshElements(c.parent);return c};d.prototype.removeNode=function(a){var b;if(b=a.parent)return a.remove(),this._refreshElements(b)};d.prototype.appendNode=function(a,b){var c;b||(b=this.tree);c=b.append(a);this._refreshElements(b);return c};d.prototype.prependNode=function(a,b){var c;b||(b=this.tree);c=b.prepend(a);this._refreshElements(b);return c};d.prototype._init=function(){d.__super__._init.apply(this,arguments);this.element=this.$el;this._initData();this.element.click(g.proxy(this._click,this));this.element.bind("contextmenu",g.proxy(this._contextmenu,this));this.$ghost=this.hovered_area=null;this.hit_areas=[];return this.is_dragging=!1};d.prototype._deinit=function(){this.element.empty();this.element.unbind();this.tree=null;return d.__super__._deinit.apply(this,arguments)};d.prototype._initData=function(){var a,b=this;if(this.options.data)return this._initTree(this.options.data);if(a=this.options.dataUrl||this.element.data("url"))return g.ajax({url:a,cache:!1,success:function(a){a=g.isArray(a)||"object"===typeof a?a:g.parseJSON(a);return b._initTree(a)}})};d.prototype._initTree=function(a){this.tree=new A;this.tree.loadFromData(a);this.selected_node=null;this._openNodes();this._refreshElements();if(this.selected_node&&(a=this._getNodeElementForNode(this.selected_node)))return a.select()};d.prototype._openNodes=function(){var a;if((!this.options.saveState||!this._restoreState())&&!1!==this.options.autoOpen)return a=!0===this.options.autoOpen?-1:parseInt(this.options.autoOpen),this.tree.iterate(function(b,c){b.is_open=!0;return c!==a})};d.prototype._refreshElements=function(a){var b,c,d,l,e,h,k,j=this;null==a&&(a=null);e=function(a){return g("<ul"+(a?"":' class="tree"')+"></ul>")};d=function(a){var b;b=a.hasChildren()?c(a):l(a);if(j.options.onCreateLi)j.options.onCreateLi(a,b);return b};l=function(a){return g('<li><div><span class="title">'+a.name+"</span></div></li>")};c=function(a){var b,c;b=["toggler"];a.is_open||b.push("closed");b=b.join(" ");c=["folder"];a.is_open||c.push("closed");c=c.join(" ");return g('<li class="'+c+'"><div><a class="'+b+'">&raquo;</a><span class="title">'+a.name+"</span></div></li>")};k=function(a,b,c,g){var l,h,j;g=e(c,g);a.append(g);h=0;for(j=b.length;h<j;h++)l=b[h],a=d(l),g.append(a),l.element=a[0],a.data("node",l),l.hasChildren()&&k(a,l.children,c+1,l.is_open);return null};a&&a.parent?(h=1,b=this._getNodeElementForNode(a),b.getUl().remove(),b=b.$element):(a=this.tree,b=this.element,b.empty(),h=0);return k(b,a.children,h,!0)};d.prototype._click=function(a){var b;if(!a.ctrlKey)if(b=g(a.target),b.is(".toggler")){if((b=this._getNodeElement(b))&&b.node.hasChildren())return b.toggle(),this.options.saveState&&this._saveState(),a.preventDefault(),a.stopPropagation()}else if(b.is("div")||b.is("span"))if((b=this._getNode(b))&&(!this.options.onCanSelectNode||this.options.onCanSelectNode(b)))return this.selectNode(b),a=g.Event("tree.click"),a.node=b,this.element.trigger(a)};d.prototype._getNode=function(a){a=a.closest("li");return 0===a.length?null:a.data("node")};d.prototype._restoreState=function(){var a;return(a=this.options.onGetStateFromStorage?this.options.onGetStateFromStorage():localStorage?localStorage.getItem(this._getCookieName()):g.cookie?g.cookie(this._getCookieName(),{path:"/"}):null)?(this._setState(a),!0):!1};d.prototype._saveState=function(){if(this.options.onSetStateFromStorage)return this.options.onSetStateFromStorage(this._getState());if(localStorage)return localStorage.setItem(this._getCookieName(),this._getState());if(g.cookie)return g.cookie(this._getCookieName(),this._getState(),{path:"/"})};d.prototype._getState=function(){var a,b;a=[];this.tree.iterate(function(b){b.is_open&&b.id&&b.hasChildren()&&a.push(b.id);return!0});b="";this.selected_node&&(b=this.selected_node.id);return x({open_nodes:a,selected_node:b})};d.prototype._setState=function(a){var b,c,d=this;if(a=g.parseJSON(a))return b=a.open_nodes,c=a.selected_node,this.tree.iterate(function(a){a.id&&a.hasChildren()&&0<=B(b,a.id)&&(a.is_open=!0);c&&a.id===c&&(d.selected_node=a);return!0})};d.prototype._getCookieName=function(){return"string"===typeof this.options.saveState?this.options.saveState:"tree"};d.prototype._getNodeElementForNode=function(a){return a.hasChildren()?new w(a,this.element):new z(a,this.element)};d.prototype._getNodeElement=function(a){return(a=this._getNode(a))?this._getNodeElementForNode(a):null};d.prototype._contextmenu=function(a){var b,c;b=g(a.target).closest("ul.tree div");if(b.length&&(c=this._getNode(b)))return a.preventDefault(),a.stopPropagation(),b=g.Event("tree.contextmenu"),b.node=c,b.click_event=a,this.element.trigger(b),!1};d.prototype._mouseCapture=function(a){if(this.options.dragAndDrop){a=g(a.target);if(this.options.onIsMoveHandle&&!this.options.onIsMoveHandle(a))return null;(a=this._getNodeElement(a))&&this.options.onCanMove&&(this.options.onCanMove(a.node)||(a=null));this.current_item=a;return null!==this.current_item}};d.prototype._mouseStart=function(a){var b;if(this.options.dragAndDrop)return this._refreshHitAreas(),b=this._getOffsetFromEvent(a),a=b[0],b=b[1],this.drag_element=new C(this.current_item.node,a,b,this.element),this.is_dragging=!0,this.current_item.$element.addClass("moving"),!0};d.prototype._mouseDrag=function(a){var b;if(this.options.dragAndDrop){this.drag_element.move(a.pageX,a.pageY);if((a=this._findHoveredArea(a.pageX,a.pageY))&&this.options.onCanMoveTo)b=j.getName(a.position),this.options.onCanMoveTo(this.current_item.node,a.node,b)||(a=null);a?this.hovered_area!==a&&(this.hovered_area=a,this._updateDropHint()):(this._removeDropHint(),this._removeHover(),this._stopOpenFolderTimer());return!0}};d.prototype._mouseStop=function(){if(this.options.dragAndDrop)return this._moveItem(),this._clear(),this._removeHover(),this._removeDropHint(),this._removeHitAreas(),this.current_item.$element.removeClass("moving"),this.is_dragging=!1};d.prototype._refreshHitAreas=function(){this._removeHitAreas();return this._generateHitAreas()};d.prototype._generateHitAreas=function(){var a,b,c,d,l,e=this;l=[];d=0;b=function(a){return a.offset().top};a=function(a,b,c){l.push({top:c,node:a,position:b});return d=c};this._iterateVisibleNodes(function(c,d,f){f=b(f);c===e.current_item.node?a(c,j.NONE,f):a(c,j.INSIDE,f);return d===e.current_item.node||c===e.current_item.node?a(c,j.NONE,f):a(c,j.AFTER,f)},function(c,d){if(c===e.current_item.node)return!1;c.children[0]!==e.current_item.node&&a(c,j.INSIDE,b(d));return!0},function(c,d,f){f=b(f);if(c===e.current_item.node)return a(c,j.NONE,f);a(c,j.INSIDE,f);if(d!==e.current_item.node)return a(c,j.AFTER,f)},function(b,c){return b===e.current_item.node||c===e.current_item.node?a(b,j.NONE,d):a(b,j.AFTER,d)},function(c){if(c!==e.current_item.node)return a(c,j.BEFORE,b(g(c.element)))});c=[];var h=function(a,b,d){var f,e,g;d=(d-b)/a.length;e=0;for(g=a.length;e<g;e++)f=a[e],c.push({top:b,bottom:b+d,node:f.node,position:f.position}),b+=d;return null},k,n,t,m,p;t=-1;k=[];m=0;for(p=l.length;m<p;m++)n=l[m],n.top!==t&&(k.length&&h(k,t,n.top),t=n.top,k=[]),k.push(n);h(k,t,e.element.offset().top+e.element.height());return this.hit_areas=c};d.prototype.testGenerateHitAreas=function(a){this.current_item=this._getNodeElementForNode(a);this._generateHitAreas();return this.hit_areas};d.prototype._removeHitAreas=function(){return this.hit_areas=[]};d.prototype._iterateVisibleNodes=function(a,b,c,d,h){var e,j;e=!0;j=function(k,n){var m,p,q,s,r;p=(k.is_open||!k.element)&&k.hasChildren();if(k.element){m=g(k.element);if(!m.is(":visible"))return;e&&(h(k,m),e=!1);k.hasChildren()?k.is_open?b(k,m)||(p=!1):c(k,n,m):a(k,n,m)}if(p){p=k.children.length;r=k.children;q=s=0;for(r=r.length;s<r;q=++s)q===p-1?j(k.children[q],null):j(k.children[q],k.children[q+1]);if(k.is_open)return d(k,n,m)}};return j(this.tree)};d.prototype._getOffsetFromEvent=function(a){var b;b=g(a.target).offset();return[a.pageX-b.left,a.pageY-b.top]};d.prototype._findHoveredArea=function(a,b){var c,d,g,e;c=this.element.offset();if(a<c.left||b<c.top||a>c.left+this.element.width()||b>c.top+this.element.height())return null;g=0;for(d=this.hit_areas.length;g<d;)if(e=g+d>>1,c=this.hit_areas[e],b<c.top)d=e;else if(b>c.bottom)g=e+1;else return c;return null};d.prototype._updateDropHint=function(){var a;this._stopOpenFolderTimer();if(this.hovered_area)return a=this.hovered_area.node,a.hasChildren()&&!a.is_open&&this.hovered_area.position===j.INSIDE&&this._startOpenFolderTimer(a),this._removeDropHint(),a=this._getNodeElementForNode(this.hovered_area.node),this.previous_ghost=a.addDropHint(this.hovered_area.position)};d.prototype._startOpenFolderTimer=function(a){var b=this;return this.open_folder_timer=setTimeout(function(){return b._getNodeElementForNode(a).open(function(){b._refreshHitAreas();return b._updateDropHint()})},500)};d.prototype._stopOpenFolderTimer=function(){if(this.open_folder_timer)return clearTimeout(this.open_folder_timer),this.open_folder_timer=null};d.prototype._removeDropHint=function(){if(this.previous_ghost)return this.previous_ghost.remove()};d.prototype._removeHover=function(){return this.hovered_area=null};d.prototype._moveItem=function(){var a,b,c,d,h,e,m=this;if(this.hovered_area&&this.hovered_area.position!==j.NONE&&(c=this.current_item.node,e=this.hovered_area.node,d=this.hovered_area.position,h=c.parent,d===j.INSIDE&&(this.hovered_area.node.is_open=!0),a=function(){m.tree.moveNode(c,e,d);m.element.empty();return m._refreshElements()},b=g.Event("tree.move"),b.move_info={moved_node:c,target_node:e,position:j.getName(d),previous_parent:h,do_move:a},this.element.trigger(b),!b.isDefaultPrevented()))return a()};d.prototype._clear=function(){this.drag_element.remove();return this.drag_element=null};p.register(d,"tree");var u=function(a,b,c){this.$element=b;this.node=a;this.$ghost=g('<li class="ghost"><span class="circle"></span><span class="line"></span></li>');c===j.AFTER?this.moveAfter():c===j.BEFORE?this.moveBefore():c===j.INSIDE&&(a.hasChildren()&&a.is_open?this.moveInsideOpenFolder():this.moveInside())};u.name="GhostDropHint";u.prototype.remove=function(){return this.$ghost.remove()};u.prototype.moveAfter=function(){return this.$element.after(this.$ghost)};u.prototype.moveBefore=function(){return this.$element.before(this.$ghost)};u.prototype.moveInsideOpenFolder=function(){return g(this.node.children[0].element).before(this.$ghost)};u.prototype.moveInside=function(){this.$element.after(this.$ghost);return this.$ghost.addClass("inside")};var y=function(a){var b;b=a.children("div");a=a.width()-4;this.$hint=g('<span class="border"></span>');b.append(this.$hint);this.$hint.css({width:a,height:b.height()-4})};y.name="BorderDropHint";y.prototype.remove=function(){return this.$hint.remove()};m=function(a,b){this.init(a,b)};m.name="NodeElement";m.prototype.init=function(a,b){this.node=a;this.tree_element=b;return this.$element=g(a.element)};m.prototype.getUl=function(){return this.$element.children("ul:first")};m.prototype.getSpan=function(){return this.$element.children("div").find("span.title")};m.prototype.getLi=function(){return this.$element};m.prototype.addDropHint=function(a){return a===j.INSIDE?new y(this.$element):new u(this.node,this.$element,a)};m.prototype.select=function(){return this.getLi().addClass("selected")};m.prototype.deselect=function(){return this.getLi().removeClass("selected")};z=m;var r=function(){return r.__super__.constructor.apply(this,arguments)};s(r,z);r.name="FolderElement";r.prototype.toggle=function(){return this.node.is_open?this.close():this.open()};r.prototype.open=function(a,b){var c,d=this;if(!this.node.is_open)return this.node.is_open=!0,this.getButton().removeClass("closed"),c=function(){var b;d.getLi().removeClass("closed");a&&a();b=g.Event("tree.open");b.node=d.node;return d.tree_element.trigger(b)},b?(this.getUl().show(),c()):this.getUl().slideDown("fast",c)};r.prototype.close=function(a){var b,c=this;if(this.node.is_open)return this.node.is_open=!1,this.getButton().addClass("closed"),b=function(){var a;c.getLi().addClass("closed");a=g.Event("tree.close");a.node=c.node;return c.tree_element.trigger(a)},a?(this.getUl().hide(),b()):this.getUl().slideUp("fast",b)};r.prototype.getButton=function(){return this.$element.children("div").find("a.toggler")};r.prototype.addDropHint=function(a){return!this.node.is_open&&a===j.INSIDE?new y(this.$element):new u(this.node,this.$element,a)};w=r;s=function(a,b,c,d){this.offset_x=b;this.offset_y=c;this.$element=g('<span class="title tree-dragging">'+a.name+"</span>");this.$element.css("position","absolute");d.append(this.$element)};s.name="DragElement";s.prototype.move=function(a,b){return this.$element.offset({left:a-this.offset_x,top:b-this.offset_y})};s.prototype.remove=function(){return this.$element.remove()};C=s;this.Tree.Node=h}).call(this);